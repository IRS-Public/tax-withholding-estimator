<?xml version="1.0"?>
<?xml-model href="./FactDictionaryModule.rng"?>
<FactDictionaryModule>
  <Facts>
    <Fact path="/jobs">
      <Description>The taxpayers's jobs</Description>
      <Writable>
        <Collection/>
      </Writable>
    </Fact>
    <Fact path="/jobs/*/yearToDateIncome">
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/jobs/*/income">
      <Description>The total income from a specific job</Description>
      <Derived>
        <Subtract>
          <Minuend>
            <Add>
              <Dependency path="../restOfYearIncome"/>
              <Dependency path="../yearToDateIncome"/>
            </Add>
          </Minuend>
          <Subtrahends>
            <Dependency path="../preTaxDeductions"/>
          </Subtrahends>
        </Subtract>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/preTaxDeductions">
      <Description>Pre-tax deductions from a specific job</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/jobs/*/yearToDateWithholding">
      <Description>The year-to-date withholding from a specific job</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/jobs/*/averageWithholdingPerPayPeriod">
      <Description>The average withholding from a specific job per pay period</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <!-- Note that the limits on dates may be more restrictive in the future based on component
         implementation -->
    <!-- E.g., a future job cannot start before tomorrow -->
    <Fact path="/jobs/*/startDate">
      <Description>The first date the job was held in the current calendar year.</Description>
      <Writable>
        <Day/>
        <Limit type="Max">
          <Day>2025-12-31</Day>
        </Limit>
      </Writable>
    </Fact>
    <Fact path="/jobs/*/endDate">
      <Description>The last date the job was held in the current calendar year.</Description>
      <Writable>
        <Day/>
        <Limit type="Max">
          <Day>2025-12-31</Day>
        </Limit>
      </Writable>
    </Fact>
    <Fact path="/jobs/*/mostRecentPayPeriodEnd">
      <Description>
        The date which the most recent pay period ended on for this particular job
      </Description>
      <Writable>
        <Day/>
        <Limit type="Max">
          <Day>2025-12-31</Day>
        </Limit>
      </Writable>
    </Fact>
    <Fact path="/jobs/*/mostRecentPayDate">
      <Description>
        The date on which pay was received, corresponding to the most recent pay period that ended
      </Description>
      <Writable>
        <Day/>
        <Limit type="Max">
          <Day>2025-12-31</Day>
        </Limit>
      </Writable>
    </Fact>
    <Fact path="/payFrequencyOptions">
      <Name>Pay Frequency Options</Name>
      <Description>Options for pay frequency</Description>
      <Derived>
        <EnumOptions>
          <String>weekly</String>
          <String>biWeekly</String>
          <String>semiMonthly</String>
          <String>monthly</String>
        </EnumOptions>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/payFrequency">
      <Name>Pay Frequency</Name>
      <Description>The frequency that the job pays the user. And the length of pay periods.</Description>
      <Writable>
        <Enum optionsPath="/payFrequencyOptions"/>
      </Writable>
    </Fact>
    <Fact path="/jobs/*/averagePayPerPayPeriod">
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/jobs/*/isPayFrequencyWeekly">
      <Derived>
        <Equal>
          <Left>
            <Dependency path="../payFrequency"/>
          </Left>
          <Right>
            <Enum optionsPath="/payFrequencyOptions">weekly</Enum>
          </Right>
        </Equal>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/isPayFrequencyBiWeekly">
      <Derived>
        <Equal>
          <Left>
            <Dependency path="../payFrequency"/>
          </Left>
          <Right>
            <Enum optionsPath="/payFrequencyOptions">biWeekly</Enum>
          </Right>
        </Equal>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/isPayFrequencySemiMonthly">
      <Derived>
        <Equal>
          <Left>
            <Dependency path="../payFrequency"/>
          </Left>
          <Right>
            <Enum optionsPath="/payFrequencyOptions">semiMonthly</Enum>
          </Right>
        </Equal>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/isPayFrequencyMonthly">
      <Derived>
        <Equal>
          <Left>
            <Dependency path="../payFrequency"/>
          </Left>
          <Right>
            <Enum optionsPath="/payFrequencyOptions">monthly</Enum>
          </Right>
        </Equal>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/payPeriodLength">
      <Description>Length of pay periods matching the Floor of Publication 15-T values.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyWeekly"/>
            </When>
            <Then>
              <Int>7</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyBiWeekly"/>
            </When>
            <Then>
              <Int>14</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencySemiMonthly"/>
            </When>
            <Then>
              <Int>15</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyMonthly"/>
            </When>
            <Then>
              <Int>30</Int>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/endDayForSemiMonthlyCalculations">
      <Description>For calculating number of pay periods for semimonthly jobs, substitute 31 with
        30 to compensate for 16 days length of the second pay period in the 31 day months
      </Description>
      <Derived>
        <LesserOf>
          <Dependency path="../endDate/day"/>
          <Int>30</Int>
        </LesserOf>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/tentativeRemainingPayPeriods">
      <Description>A preliminary calculation of remaining pay periods for weekly and biweekly
        frequencies, to be adjusted because it may extend past the end of the year.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Any>
                <Dependency path="../isPayFrequencyWeekly"/>
                <Dependency path="../isPayFrequencyBiWeekly"/>
              </Any>
            </When>
            <Then>
              <Ceiling>
                <Divide>
                  <Dividend>
                    <Subtract>
                      <Minuend>
                        <Dependency path="../endDate/ordinal"/>
                      </Minuend>
                      <Subtrahends>
                        <Dependency path="../mostRecentPayPeriodEnd/ordinal"/>
                      </Subtrahends>
                    </Subtract>
                  </Dividend>
                  <Divisors>
                    <Dependency path="../payPeriodLength"/>
                  </Divisors>
                </Divide>
              </Ceiling>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/predictedOrdinalFinalPayDate">
      <Description>For weekly and biweekly jobs, the final pay date predicted by the tentative
        calculation of remaining pay periods-- which may be past the end of year.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Any>
                <Dependency path="../isPayFrequencyWeekly"/>
                <Dependency path="../isPayFrequencyBiWeekly"/>
              </Any>
            </When>
            <Then>
              <Add>
                <Dependency path="../mostRecentPayDate/ordinal"/>
                <Multiply>
                  <Dependency path="../tentativeRemainingPayPeriods"/>
                  <Dependency path="../payPeriodLength"/>
                </Multiply>
              </Add>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/remainingPayPeriods">
      <Description>
        The number of pay dates remaining in the year.

        Monthly and semimonthly are computed directly.

        Weekly and biweekly are computed using `../tentativeRemainingPayPeriods` and
        `../predictedOrdinalFinalPayDate` to make any necessary adjustment when the tentative
        calculation overflows the end of year.
        For example, let's say you are paid weekly every Friday for the previous week, and you're
        working through EOY.
        Then (in 2025) you will be paid on the 2nd of January 2026 for 12/21-27, and on the 9th of
        January 2026 for 12/28-01/03. That's two pay periods that are in 2025 that will be paid for
        (and taxed in) 2026.
      </Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyMonthly"/>
            </When>
            <Then>
              <Add>
                <!-- Months remaining in the job ... -->
                <Subtract>
                  <Minuend>
                    <Dependency path="../endDate/month"/>
                  </Minuend>
                  <Subtrahends>
                    <Dependency path="../mostRecentPayDate/month"/>
                  </Subtrahends>
                </Subtract>
                <!-- ... plus one if needed for pay lag AND that does not take us past EOY. -->
                <Switch>
                  <Case>
                    <When>
                      <All>
                        <GreaterThan>
                          <Left>
                            <Dependency path="../endDate/ordinal"/>
                          </Left>
                          <Right>
                            <Dependency path="../mostRecentPayPeriodEnd/ordinal"/>
                          </Right>
                        </GreaterThan>
                        <NotEqual>
                          <Left>
                            <Dependency path="../endDate/month"/>
                          </Left>
                          <Right>
                            <Int>12</Int>
                          </Right>
                        </NotEqual>
                      </All>
                    </When>
                    <Then>
                      <Int>1</Int>
                    </Then>
                  </Case>
                  <Case>
                    <When>
                      <True/>
                    </When>
                    <Then>
                      <Int>0</Int>
                    </Then>
                  </Case>
                </Switch>
              </Add>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencySemiMonthly"/>
            </When>
            <Then>
              <!-- Add three numbers:
               remaining pay periods "this" month (if it is not the final month)
               + pay periods for whole months intervening
               + remaining pay periods for final month -->
              <Add>
                <!-- For "this" month (of most recent pay date) ...  -->
                <Switch>
                  <Case>
                    <When>
                      <All>
                        <!-- ... when it's not the final month ...  -->
                        <NotEqual>
                          <Left>
                            <Dependency path="../mostRecentPayDate/month"/>
                          </Left>
                          <Right>
                            <Dependency path="../endDate/month"/>
                          </Right>
                        </NotEqual>
                        <!-- ... and we were last paid in the first half of the month ...  -->
                        <LessThanOrEqual>
                          <Left>
                            <Dependency path="../mostRecentPayDate/day"/>
                          </Left>
                          <Right>
                            <Dependency path="../payPeriodLength"/>
                          </Right>
                        </LessThanOrEqual>
                      </All>
                    </When>
                    <Then>
                      <!-- ... then we'll get paid once more this month ...  -->
                      <Int>1</Int>
                    </Then>
                  </Case>
                  <Case>
                    <When>
                      <True/>
                    </When>
                    <Then>
                      <!-- ... otherwise no more this month.  -->
                      <Int>0</Int>
                    </Then>
                  </Case>
                </Switch>
                <!-- For full months between now and end date ...  -->
                <GreaterOf>
                  <Int>0</Int>
                  <Multiply>
                    <!-- ... we get paid twice each.  -->
                    <Int>2</Int>
                    <Subtract>
                      <Minuend>
                        <Dependency path="../endDate/month"/>
                      </Minuend>
                      <Subtrahends>
                        <Dependency path="../mostRecentPayDate/month"/>
                        <Int>1</Int>
                      </Subtrahends>
                    </Subtract>
                  </Multiply>
                </GreaterOf>
                <!-- For the final month ...  -->
                <Switch>
                  <Case>
                    <When>
                      <!-- ... when we were most recently paid in the final month ... -->
                      <Equal>
                        <Left>
                          <Dependency path="../mostRecentPayDate/month"/>
                        </Left>
                        <Right>
                          <Dependency path="../endDate/month"/>
                        </Right>
                      </Equal>
                    </When>
                    <Then>
                      <Switch>
                        <Case>
                          <When>
                            <All>
                              <!-- ... and it was for the first half ...  -->
                              <LessThanOrEqual>
                                <Left>
                                  <Dependency path="../mostRecentPayDate/day"/>
                                </Left>
                                <Right>
                                  <Dependency path="../payPeriodLength"/>
                                </Right>
                              </LessThanOrEqual>
                              <!-- ... and we have not been paid through the end date ... -->
                              <GreaterThan>
                                <Left>
                                  <Dependency path="../endDate/ordinal"/>
                                </Left>
                                <Right>
                                  <Dependency path="../mostRecentPayPeriodEnd/ordinal"/>
                                </Right>
                              </GreaterThan>
                            </All>
                          </When>
                          <Then>
                            <!-- ... then one payment still remains; ... -->
                            <Int>1</Int>
                          </Then>
                        </Case>
                        <Case>
                          <When>
                            <True/>
                          </When>
                          <Then>
                            <!-- ... otherwise, no payments remain.  -->
                            <Int>0</Int>
                          </Then>
                        </Case>
                      </Switch>
                    </Then>
                  </Case>
                  <Case>
                    <When>
                      <!-- ... otherwise if the first payment pays us through the end date ...   -->
                      <All>
                        <LessThanOrEqual>
                          <Left>
                            <Dependency path="../endDate/day"/>
                          </Left>
                          <Right>
                            <Int>15</Int>
                          </Right>
                        </LessThanOrEqual>
                        <LessThanOrEqual>
                          <Left>
                            <Dependency path="../endDate/day"/>
                          </Left>
                          <Right>
                            <Dependency path="../mostRecentPayPeriodEnd/day"/>
                          </Right>
                        </LessThanOrEqual>
                      </All>
                    </When>
                    <Then>
                      <!-- ... then that's the only remaining payment; ...  -->
                      <Int>1</Int>
                    </Then>
                  </Case>
                  <Case>
                    <!-- ... otherwise we're paid twice in the month.  -->
                    <When>
                      <True/>
                    </When>
                    <Then>
                      <Int>2</Int>
                    </Then>
                  </Case>
                </Switch>
              </Add>
            </Then>
          </Case>
          <Case>
            <!-- For weekly or biweekly ... -->
            <When>
              <!-- When the final pay date predicted by tentative calculation is past EOY ... -->
              <GreaterThan>
                <Left>
                  <Dependency path="../predictedOrdinalFinalPayDate"/>
                </Left>
                <Right>
                  <Dependency path="/daysInYear"/>
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <!-- ... adjust the tentative number to account for that. -->
              <Subtract>
                <Minuend>
                  <Dependency path="../tentativeRemainingPayPeriods"/>
                </Minuend>
                <Subtrahends>
                  <Ceiling>
                    <Divide>
                      <Dividend>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../predictedOrdinalFinalPayDate"/>
                          </Minuend>
                          <Subtrahends>
                            <Dependency path="/daysInYear"/>
                          </Subtrahends>
                        </Subtract>
                      </Dividend>
                      <Divisors>
                        <Dependency path="../payPeriodLength"/>
                      </Divisors>
                    </Divide>
                  </Ceiling>
                </Subtrahends>
              </Subtract>
            </Then>
          </Case>
          <Case>
            <!-- When the predicted final pay date is within the year, then no adjustment is needed. -->
            <When>
              <True/>
            </When>
            <Then>
              <Dependency path="../tentativeRemainingPayPeriods"/>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/ordinalEffectiveEndDate">
      <Description>The date that is effectively the user's last day worked for this job as far as
        income counting towards this year is concerned. Not used or defined for semimontly jobs.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Not>
                <Dependency path="../isPayFrequencySemiMonthly"/>
              </Not>
            </When>
            <Then>
              <Switch>
                <Case>
                  <When>
                    <!-- For a job that is held to end of year, calculate the last "paid for" date
                    ... -->
                    <Equal>
                      <Left>
                        <Dependency path="../endDate/ordinal"/>
                      </Left>
                      <Right>
                        <Dependency path="/daysInYear"/>
                      </Right>
                    </Equal>
                  </When>
                  <Then>
                    <Add>
                      <Dependency path="../mostRecentPayPeriodEnd/ordinal"/>
                      <Multiply>
                        <Dependency path="../remainingPayPeriods"/>
                        <Dependency path="../payPeriodLength"/>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <Case>
                  <When>
                    <!-- ... otherwise, it's the early end date. -->
                    <True/>
                  </When>
                  <Then>
                    <Dependency path="../endDate/ordinal"/>
                  </Then>
                </Case>
              </Switch>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/fractionalRemainingPayPeriods">
      <Description>The fractional amount of remaining pay periods, for use in calculating resulting
        eoy total income.</Description>
      <Derived>
        <Switch>
          <!-- Semimonthly payments -->
          <Case>
            <When>
              <Dependency path="../isPayFrequencySemiMonthly"/>
            </When>
            <Then>
              <!-- Use diff between the last pay period and end day -->
              <Divide>
                <Dividend>
                  <GreaterOf>
                    <Int>0</Int>
                    <Add>
                      <Dependency path="../diffBetweenLastPayDateAndEndDate"/>
                      <Multiply>
                        <Dependency path="../remainingPayPeriods"/>
                        <Dependency path="../payPeriodLength"/>
                      </Multiply>
                    </Add>
                  </GreaterOf>
                </Dividend>
                <Divisors>
                  <Dependency path="../payPeriodLength"/>
                </Divisors>
              </Divide>
            </Then>
          </Case>
          <!-- The user has been through at least one pay period -->
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Divide>
                <Dividend>
                  <Subtract>
                    <Minuend>
                      <Dependency path="../ordinalEffectiveEndDate"/>
                    </Minuend>
                    <Subtrahends>
                      <Dependency path="../mostRecentPayPeriodEnd/ordinal"/>
                    </Subtrahends>
                  </Subtract>
                </Dividend>
                <Divisors>
                  <Dependency path="../payPeriodLength"/>
                </Divisors>
              </Divide>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/totalBonusReceived">
      <Description>The total amount of bonus per year for a specific job</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/totalBonusReceivedThreshold">
      <Description>Threshold for changing bonus withholdings from 22% to 37%</Description>
      <TaxYear>2025</TaxYear>
      <Derived>
        <Dollar>1000000</Dollar>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/withholdingsFromTotalBonusReceived">
      <Description>Bonus withholdings are 22% if less than 1,000,000 and 37% on the sum exceeding
        1,000,000</Description>
      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <LessThanOrEqual>
                  <Left>
                    <Dependency path="../totalBonusReceived"/>
                  </Left>
                  <Right>
                    <Dependency path="/totalBonusReceivedThreshold"/>
                  </Right>
                </LessThanOrEqual>
              </When>
              <Then>
                <Multiply>
                  <Rational>22/100</Rational>
                  <Dependency path="../totalBonusReceived"/>
                </Multiply>
              </Then>
            </Case>
            <Case>
              <When>
                <True/>
              </When>
              <Then>
                <Add>
                  <!-- 22% on the first $1,000,000-->
                  <Multiply>
                    <Rational>22/100</Rational>
                    <Dependency path="/totalBonusReceivedThreshold"/>
                  </Multiply>
                  <!-- 37% on the amount exceeding $1,000,000-->
                  <Multiply>
                    <Rational>37/100</Rational>
                    <Subtract>
                      <Minuend>
                        <Dependency path="../totalBonusReceived"/>
                      </Minuend>
                      <Subtrahends>
                        <Dependency path="/totalBonusReceivedThreshold"/>
                      </Subtrahends>
                    </Subtract>
                  </Multiply>
                </Add>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/w4Line4a">
      <Description>Form W-4 Line 4(a); also Pub 15-T Worksheet 1A Line 1d.</Description>
      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <Equal>
                  <Left>
                    <Dependency path=".."/>
                  </Left>
                  <Right>
                    <Dependency path="/jobSelectedForExtraWithholding"/>
                  </Right>
                </Equal>
              </When>
              <Then>
                <Dependency path="/totalOtherIncome"/>
              </Then>
            </Case>
            <Case>
              <When>
                <True/>
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/w4Line4b">
      <Description>Form W-4 Line 4(b); also Pub 15-T Worksheet 1A Line 1f.</Description>
      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <Equal>
                  <Left>
                    <Dependency path=".."/>
                  </Left>
                  <Right>
                    <Dependency path="/jobSelectedForExtraWithholding"/>
                  </Right>
                </Equal>
              </When>
              <Then>
                <Dependency path="/adjustmentsToIncome"/>
              </Then>
            </Case>
            <Case>
              <When>
                <True/>
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/payPeriodsBeforeW4ChangesAppear">
      <Description>This is derived from the "2197 Scenarios checks" worksheet of the
        "TWESprint1_2025_UAT_WHC2197_2200" spreadsheet.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyWeekly"/>
            </When>
            <Then>
              <Int>2</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Any>
                <Dependency path="../isPayFrequencyBiWeekly"/>
                <Dependency path="../isPayFrequencySemiMonthly"/>
              </Any>
            </When>
            <Then>
              <Int>1</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyMonthly"/>
            </When>
            <Then>
              <Int>0</Int>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/w4Line4c">
      <Derived>
        <Switch>
          <Case>
            <When>
              <Equal>
                <Left>
                  <Dependency path=".."/>
                </Left>
                <Right>
                  <Dependency path="/jobSelectedForExtraWithholding"/>
                </Right>
              </Equal>
            </When>
            <Then>
              <Round>
                <Divide>
                  <Dividend>
                    <Subtract>
                      <Minuend>
                        <Dependency path="/totalTax"/>
                      </Minuend>
                      <Subtrahends>
                        <Dependency path="/totalCommittedWithholding"/>
                      </Subtrahends>
                    </Subtract>
                  </Dividend>
                  <Divisors>
                    <Subtract>
                      <Minuend>
                        <Dependency path="../remainingPayPeriods"/>
                      </Minuend>
                      <Subtrahends>
                        <Dependency path="../payPeriodsBeforeW4ChangesAppear"/>
                      </Subtrahends>
                    </Subtract>
                  </Divisors>
                </Divide>
              </Round>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/pub15Worksheet1aLine1g">
      <Description>Line 1g of Pub 15-T Worksheet 1A</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="/isFilingStatusMFJ"/>
            </When>
            <Then>
              <Dollar>12900</Dollar>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>8600</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/adjustedAnnualWageAmount">
      <Description>Line 1i of Pub 15-T Worksheet 1A</Description>
      <Derived>
        <GreaterOf>
          <Dollar>0</Dollar>
          <Subtract>
            <Minuend>
              <Add>
                <Multiply>
                  <Dependency path="../averagePayPerPayPeriod"/>
                  <Dependency path="../payPeriodsPerYear"/>
                </Multiply>
                <Dependency path="../w4Line4a"/>
              </Add>
            </Minuend>
            <Subtrahends>
              <Dependency path="../w4Line4b"/>
              <Dependency path="../pub15Worksheet1aLine1g"/>
            </Subtrahends>
          </Subtract>
        </GreaterOf>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/standardAnnualWithholdingAmount">
      <Description>Standard withholding rate schedules for use when Form W-4 Step 2 box is not
        checked. Line 2g of Pub. 15-T Worksheet 1A. These amounts are generally a base withholding
        amount plus a percentage of the excess of Annual Adjusted Wages Amount. The base withholding
        captures the total withholding for all the brackets below the one that the AAWA falls into. </Description>
      <TaxYear>2025</TaxYear>
      <Derived>
        <Switch>
          <!-- SINGLE OR MARRIED FILING SEPARATELY -->
          <Case>
            <When>
              <Any>
                <Dependency module="filingStatus" path="/isFilingStatusSingle"/>
                <Dependency module="filingStatus" path="/isFilingStatusMFS"/>
              </Any>
            </When>
            <Then>
              <Switch>
                <!-- Less than $6,400: no withholding -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>6400</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Dollar>0</Dollar>
                  </Then>
                </Case>
                <!-- At least $6,400 but less than $18,325: $0 plus 10% of the excess over $6,400 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>18325</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Multiply>
                      <Rational>10/100</Rational>
                      <Subtract>
                        <Minuend>
                          <Dependency path="../adjustedAnnualWageAmount"/>
                        </Minuend>
                        <Subtrahends>
                          <Dollar>6400</Dollar>
                        </Subtrahends>
                      </Subtract>
                    </Multiply>
                  </Then>
                </Case>
                <!-- At least $18,325 but less than $54,875: $1,192.50 plus 12% of the excess over
            $18,325 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>54875</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>1192.50</Dollar>
                      <Multiply>
                        <Rational>12/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>18325</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- At least $54,875 but less than $109,750: $5,578.50 plus 22% of the excess
                  over $54,875 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>109750</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>5578.50</Dollar>
                      <Multiply>
                        <Rational>22/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>54875</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- At least $109,750 but less than $203,700: $17,651 plus 24% of the excess over
                  $109,750 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>203700</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>17651</Dollar>
                      <Multiply>
                        <Rational>24/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>109750</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- At least $203,700 but less than $256,925: $40,199 plus 32% of the excess over
                  $203,700 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>256925</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>40199</Dollar>
                      <Multiply>
                        <Rational>32/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>203700</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- At least $256,925 but less than $632,750: $57,231 plus 35% of the excess over
                  $256,925 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>632750</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>57231</Dollar>
                      <Multiply>
                        <Rational>35/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>256925</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- $632,750 and above: $188,769.75 plus 37% of the excess over $632,750 -->
                <Case>
                  <When>
                    <True/>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>188769.75</Dollar>
                      <Multiply>
                        <Rational>37/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>632750</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
              </Switch>
            </Then>
          </Case>
          <Case>
            <When>
              <Any>
                <Dependency module="filingStatus" path="/isFilingStatusMFJ"/>
                <Dependency module="filingStatus" path="/isFilingStatusQSS"/>
              </Any>
            </When>
            <Then>
              <Switch>
                <!-- Less than $17,100: no withholding -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>17100</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Dollar>0</Dollar>
                  </Then>
                </Case>
                <!-- At least $17,100 but less than $40,950: $0 plus 10% of the excess over
                  $17,100 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>40950</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Multiply>
                      <Rational>10/100</Rational>
                      <Subtract>
                        <Minuend>
                          <Dependency path="../adjustedAnnualWageAmount"/>
                        </Minuend>
                        <Subtrahends>
                          <Dollar>17100</Dollar>
                        </Subtrahends>
                      </Subtract>
                    </Multiply>
                  </Then>
                </Case>
                <!-- At least $40,950 but less than $114,050: $2,385 plus 12% of the excess over
                  $40,950 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>114050</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>2385</Dollar>
                      <Multiply>
                        <Rational>12/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>40950</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- At least $114,050 but less than $223,800: $11,157 plus 22% of the excess over
                  $114,050 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>223800</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>11157</Dollar>
                      <Multiply>
                        <Rational>22/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>114050</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- At least $223,800 but less than $411,700: $35,302 plus 24% of the excess over
                  $223,800 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>411700</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>35302</Dollar>
                      <Multiply>
                        <Rational>24/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>223800</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- At least $411,700 but less than $518,150: $80,398 plus 32% of the excess over
                  $411,700 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>518150</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>80398</Dollar>
                      <Multiply>
                        <Rational>32/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>411700</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- At least $518,150 but less than $768,700: $114,462 plus 35% of the excess
                  over $518,150 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>768700</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>114462</Dollar>
                      <Multiply>
                        <Rational>35/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>518150</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- $768,700 and above: $202,154.50 plus 37% of the excess over $768,700 -->
                <Case>
                  <When>
                    <True/>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>202154.50</Dollar>
                      <Multiply>
                        <Rational>37/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>768700</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
              </Switch>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency module="filingStatus" path="/isFilingStatusHOH"/>
            </When>
            <Then>
              <Switch>
                <!-- Less than $13,900: no withholding -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>13900</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Dollar>0</Dollar>
                  </Then>
                </Case>
                <!-- At least $13,900 but less than $30,900: $0 plus 10% of the excess over
                  $13,900 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>30900</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Multiply>
                      <Rational>10/100</Rational>
                      <Subtract>
                        <Minuend>
                          <Dependency path="../adjustedAnnualWageAmount"/>
                        </Minuend>
                        <Subtrahends>
                          <Dollar>13900</Dollar>
                        </Subtrahends>
                      </Subtract>
                    </Multiply>
                  </Then>
                </Case>
                <!-- At least $30,900 but less than $78,750: $1,700 plus 12% of the excess over
                  $30,900 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>78750</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>1700</Dollar>
                      <Multiply>
                        <Rational>12/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>30900</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- At least $78,750 but less than $117,250: $7,442 plus 22% of the excess over
                  $78,750 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>117250</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>7442</Dollar>
                      <Multiply>
                        <Rational>22/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>78750</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- At least $117,250 but less than $211,200: $15,912 plus 24% of the excess over
                  $117,250 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>211200</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>15912</Dollar>
                      <Multiply>
                        <Rational>24/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>117250</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- At least $211,200 but less than $264,400: $38,460 plus 32% of the excess over
                  $211,200 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>264400</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>38460</Dollar>
                      <Multiply>
                        <Rational>32/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>211200</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- At least $264,400 but less than $640,250: $55,484 plus 35% of the excess over
                  $264,400 -->
                <Case>
                  <When>
                    <LessThan>
                      <Left>
                        <Dependency path="../adjustedAnnualWageAmount"/>
                      </Left>
                      <Right>
                        <Dollar>640250</Dollar>
                      </Right>
                    </LessThan>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>55484</Dollar>
                      <Multiply>
                        <Rational>35/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>264400</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
                <!-- $640,250 and above: $187,031.50 plus 37% of the excess over $640,250 -->
                <Case>
                  <When>
                    <True/>
                  </When>
                  <Then>
                    <Add>
                      <Dollar>187031.50</Dollar>
                      <Multiply>
                        <Rational>37/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../adjustedAnnualWageAmount"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>640250</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Add>
                  </Then>
                </Case>
              </Switch>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/tentativeWithholdingAmount">
      <Description>Line 2h of Pub. 15-T Worksheet 1A. The amount from the Annual Method Percentage
        table.</Description>
      <Derived>
        <Divide>
          <Dividend>
            <Dependency path="../standardAnnualWithholdingAmount"/>
          </Dividend>
          <Divisors>
            <Dependency path="../payPeriodsPerYear"/>
          </Divisors>
        </Divide>
      </Derived>
    </Fact>
    <!-- TODO: Eventually implement -->
    <!-- <Fact path="/jobs/*/baseWithholding">
      <Description>Line 3c of Pub. 15-T Worksheet 1A. The per-period withholding amount, excluding
        any extra elected on Form W-4 Line 4(c).</Description>
      <Derived>
        <GreaterOf>
          <Dollar>0</Dollar>
          <Subtract>
            <Minuend>
              <Dependency path="../tentativeWithholdingAmount" />
            </Minuend>
            <Subtrahends>
              <Divide>
                <Dividend>
                  <Dependency path="/totalCredits" />
                </Dividend>
                <Divisors>
                  <Dependency path="../payPeriodsPerYear" />
                </Divisors>
              </Divide>
            </Subtrahends>
          </Subtract>
        </GreaterOf>
      </Derived>
    </Fact> -->
    <Fact path="/jobs/*/endOfYearProjectedWithholding">
      <Description>The end of year amount withheld for this job if nothing is changed.</Description>
      <Derived>
        <Add>
          <Dependency path="../yearToDateWithholding"/>
          <Multiply>
            <!-- Floor is used here to match QA spreadsheet calculation -->
            <Floor>
              <Dependency path="../fractionalRemainingPayPeriods"/>
            </Floor>
            <Dependency path="../averageWithholdingPerPayPeriod"/>
          </Multiply>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/restOfYearIncome">
      <Description>This amount this job will pay for the rest of the year.</Description>
      <Derived>
        <Multiply>
          <Dependency path="../averagePayPerPayPeriod"/>
          <Dependency path="../fractionalRemainingPayPeriods"/>
        </Multiply>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/payPeriodsPerYear">
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyWeekly"/>
            </When>
            <Then>
              <Int>52</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyBiWeekly"/>
            </When>
            <Then>
              <Int>26</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencySemiMonthly"/>
            </When>
            <Then>
              <Int>24</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyMonthly"/>
            </When>
            <Then>
              <Int>12</Int>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/committedWithholding">
      <Description>This job's withholding that cannot change because it's past or within the time
        lag before W4 changes kick in.</Description>
      <Derived>
        <Add>
          <!-- past withholding -->
          <Dependency path="../yearToDateWithholding"/>
          <!-- future withholding, too soon to be changed -->
          <Multiply>
            <Dependency path="../averageWithholdingPerPayPeriod"/>
            <LesserOf>
              <Floor>
                <Dependency path="../fractionalRemainingPayPeriods"/>
              </Floor>
              <Dependency path="../remainingPayPeriods"/>
              <Dependency path="../payPeriodsBeforeW4ChangesAppear"/>
            </LesserOf>
          </Multiply>
          <!-- future tentative withholding: result from Pub 15-T Worksheet 1A  -->
          <!-- For now, we treat this as a "given" that won't change. Probably will need to revisit
          this when we get to reducing below tentative withholding. -->
          <Multiply>
            <Dependency path="../tentativeWithholdingAmount"/>
            <GreaterOf>
              <Int>0</Int>
              <Subtract>
                <Minuend>
                  <!-- Floor is used here to match QA spreadsheet calculation -->
                  <Floor>
                    <Dependency path="../fractionalRemainingPayPeriods"/>
                  </Floor>
                </Minuend>
                <Subtrahends>
                  <Dependency path="../payPeriodsBeforeW4ChangesAppear"/>
                </Subtrahends>
              </Subtract>
            </GreaterOf>
          </Multiply>
          <!-- witholding from the bonus, formula is different than for the regular job payments-->
          <Dependency path="../withholdingsFromTotalBonusReceived"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/w4pLine2bi">
      <Description>
        Total income from jobs + any W-4 Line 4a incomes (non-job, non-pension/annuity).
      </Description>
      <Derived>
        <Add>
          <Dependency path="/totalJobsIncome"/>
          <CollectionSum>
            <Dependency path="/jobs/*/w4Line4a"/>
          </CollectionSum>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/w4pLine2bii">
      <Description>The sum of all other taxable pension income, excluding the income from the single
        highest paying pension.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Equal>
                <Left>
                  <Dependency path=".."/>
                </Left>
                <Right>
                  <Dependency path="/pensionSelectedForExtraWithholding"/>
                </Right>
              </Equal>
            </When>
            <Then>
              <Subtract>
                <Minuend>
                  <Dependency path="/totalPensionsIncome"/>
                </Minuend>
                <Subtrahends>
                  <Dependency path="/pensionSelectedForExtraWithholding/income"/>
                </Subtrahends>
              </Subtract>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/w4pLine2biii">
      <Description> Sum of Line 2bi and 2bii, may be negative.</Description>
      <Derived>
        <Add>
          <Dependency path="../w4pLine2bi"/>
          <Dependency path="../w4pLine2bii"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/w4pLine4a">
      <Description>Total non-job or pension/annuity income.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <All>
                <Equal>
                  <Left>
                    <Dependency path=".."/>
                  </Left>
                  <Right>
                    <Dependency path="/pensionSelectedForExtraWithholding"/>
                  </Right>
                </Equal>
                <Equal>
                  <Left>
                    <Dependency path="../w4pLine2bi"/>
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </Equal>
              </All>
            </When>
            <Then>
              <Round>
                <Dependency path="/totalOtherIncome"/>
              </Round>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/w4pLine4b">
      <Description>Other deductions to income.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <All>
                <Equal>
                  <Left>
                    <Dependency path=".."/>
                  </Left>
                  <Right>
                    <Dependency path="/pensionSelectedForExtraWithholding"/>
                  </Right>
                </Equal>
                <Equal>
                  <Left>
                    <Dependency path="../w4pLine2bi"/>
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </Equal>
              </All>
            </When>
            <Then>
              <Dependency path="/adjustmentsToIncome"/>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/pub15Worksheet1bLine1g">
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="/isFilingStatusMFJ"/>
            </When>
            <Then>
              <Dollar>12900</Dollar>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>8600</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/adjustedAnnualPaymentAmount">
      <Description>Projected yearly pay with deductions removed.</Description>
      <Derived>
        <Subtract>
          <Minuend>
            <Add>
              <Dependency path="../income"/>
              <Dependency path="../w4pLine4a"/>
            </Add>
          </Minuend>
          <Subtrahends>
            <Dependency path="../w4pLine4b"/>
            <Dependency path="../pub15Worksheet1bLine1g"/>
          </Subtrahends>
        </Subtract>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/pub15Worksheet1bLine2cOr2d">
      <Description>Adjusted total other income (2c), or adjusted annual payment amount (2d).</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Not>
                <Equal>
                  <Left>
                    <Dependency path="../w4pLine2biii"/>
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </Equal>
              </Not>
            </When>
            <Then>
              <GreaterOf>
                <Dollar>0</Dollar>
                <Subtract>
                  <Minuend>
                    <Dependency path="../w4pLine2biii"/>
                  </Minuend>
                  <Subtrahends>
                    <Dependency path="../pub15Worksheet1bLine1g"/>
                  </Subtrahends>
                </Subtract>
              </GreaterOf>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dependency path="../adjustedAnnualPaymentAmount"/>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/pub15Worksheet1bLine2j">
      <Description>
        Standard withholding rate schedules for the form W-4P. Line 2j of Pub. 15-T Worksheet 1B.
        These amounts are generally a base withholding amount plus a percentage of the excess of
        Annual Adjusted Wages Amount. The base withholding captures the total withholding for all
        the brackets below the one that the AAWA falls into.
      </Description>
      <TaxYear>2025</TaxYear>
      <Derived>
        <Round>
          <Switch>
            <!-- SINGLE OR MARRIED FILING SEPARATELY -->
            <Case>
              <When>
                <Any>
                  <Dependency module="filingStatus" path="/isFilingStatusSingle"/>
                  <Dependency module="filingStatus" path="/isFilingStatusMFS"/>
                </Any>
              </When>
              <Then>
                <Switch>
                  <!-- Less than $6,400: no withholding -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>6400</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Dollar>0</Dollar>
                    </Then>
                  </Case>
                  <!-- At least $6,400 but less than $18,325: $0 plus 10% of the excess over $6,400 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>18325</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Multiply>
                        <Rational>10/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>6400</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Then>
                  </Case>
                  <!-- At least $18,325 but less than $54,875: $1,192.50 plus 12% of the excess over
            $18,325 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>54875</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>1192.50</Dollar>
                        <Multiply>
                          <Rational>12/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>18325</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $54,875 but less than $109,750: $5,578.50 plus 22% of the excess
                  over $54,875 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>109750</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>5578.50</Dollar>
                        <Multiply>
                          <Rational>22/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>54875</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $109,750 but less than $203,700: $17,651 plus 24% of the excess over
                  $109,750 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>203700</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>17651</Dollar>
                        <Multiply>
                          <Rational>24/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>109750</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $203,700 but less than $256,925: $40,199 plus 32% of the excess over
                  $203,700 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>256925</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>40199</Dollar>
                        <Multiply>
                          <Rational>32/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>203700</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $256,925 but less than $632,750: $57,231 plus 35% of the excess over
                  $256,925 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>632750</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>57231</Dollar>
                        <Multiply>
                          <Rational>35/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>256925</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- $632,750 and above: $188,769.75 plus 37% of the excess over $632,750 -->
                  <Case>
                    <When>
                      <True/>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>188769.75</Dollar>
                        <Multiply>
                          <Rational>37/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>632750</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                </Switch>
              </Then>
            </Case>
            <Case>
              <When>
                <Any>
                  <Dependency module="filingStatus" path="/isFilingStatusMFJ"/>
                  <Dependency module="filingStatus" path="/isFilingStatusQSS"/>
                </Any>
              </When>
              <Then>
                <Switch>
                  <!-- Less than $17,100: no withholding -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>17100</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Dollar>0</Dollar>
                    </Then>
                  </Case>
                  <!-- At least $17,100 but less than $40,950: $0 plus 10% of the excess over
                  $17,100 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>40950</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Multiply>
                        <Rational>10/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>17100</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Then>
                  </Case>
                  <!-- At least $40,950 but less than $114,050: $2,385 plus 12% of the excess over
                  $40,950 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>114050</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>2385</Dollar>
                        <Multiply>
                          <Rational>12/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>40950</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $114,050 but less than $223,800: $11,157 plus 22% of the excess over
                  $114,050 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>223800</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>11157</Dollar>
                        <Multiply>
                          <Rational>22/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>114050</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $223,800 but less than $411,700: $35,302 plus 24% of the excess over
                  $223,800 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>411700</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>35302</Dollar>
                        <Multiply>
                          <Rational>24/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>223800</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $411,700 but less than $518,150: $80,398 plus 32% of the excess over
                  $411,700 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>518150</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>80398</Dollar>
                        <Multiply>
                          <Rational>32/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>411700</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $518,150 but less than $768,700: $114,462 plus 35% of the excess
                  over $518,150 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>768700</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>114462</Dollar>
                        <Multiply>
                          <Rational>35/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>518150</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- $768,700 and above: $202,154.50 plus 37% of the excess over $768,700 -->
                  <Case>
                    <When>
                      <True/>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>202154.50</Dollar>
                        <Multiply>
                          <Rational>37/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>768700</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                </Switch>
              </Then>
            </Case>
            <Case>
              <When>
                <Dependency module="filingStatus" path="/isFilingStatusHOH"/>
              </When>
              <Then>
                <Switch>
                  <!-- Less than $13,900: no withholding -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>13900</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Dollar>0</Dollar>
                    </Then>
                  </Case>
                  <!-- At least $13,900 but less than $30,900: $0 plus 10% of the excess over
                  $13,900 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>30900</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Multiply>
                        <Rational>10/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>13900</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Then>
                  </Case>
                  <!-- At least $30,900 but less than $78,750: $1,700 plus 12% of the excess over
                  $30,900 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>78750</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>1700</Dollar>
                        <Multiply>
                          <Rational>12/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>30900</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $78,750 but less than $117,250: $7,442 plus 22% of the excess over
                  $78,750 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>117250</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>7442</Dollar>
                        <Multiply>
                          <Rational>22/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>78750</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $117,250 but less than $211,200: $15,912 plus 24% of the excess over
                  $117,250 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>211200</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>15912</Dollar>
                        <Multiply>
                          <Rational>24/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>117250</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $211,200 but less than $264,400: $38,460 plus 32% of the excess over
                  $211,200 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>264400</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>38460</Dollar>
                        <Multiply>
                          <Rational>32/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>211200</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $264,400 but less than $640,250: $55,484 plus 35% of the excess over
                  $264,400 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                        </Left>
                        <Right>
                          <Dollar>640250</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>55484</Dollar>
                        <Multiply>
                          <Rational>35/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>264400</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- $640,250 and above: $187,031.50 plus 37% of the excess over $640,250 -->
                  <Case>
                    <When>
                      <True/>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>187031.50</Dollar>
                        <Multiply>
                          <Rational>37/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2cOr2d"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>640250</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                </Switch>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/pub15Worksheet1bLine2m">
      <Derived>
        <GreaterOf>
          <Add>
            <Dependency path="../w4pLine2biii"/>
            <Dependency path="../adjustedAnnualPaymentAmount"/>
          </Add>
          <Dollar>0</Dollar>
        </GreaterOf>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/pub15Worksheet1bLine2s">
      <Description>Standard withholding rate schedules for use when Form W-4P Step 2(b)iii box is
        filled.
        Line 2s of Pub. 15-T Worksheet 1b. These amounts are generally a base withholding
        amount plus a percentage of the excess of Annual Adjusted Wages Amount. The base withholding
        captures the total withholding for all the brackets below the one that the AAWA falls into.
      </Description>
      <TaxYear>2025</TaxYear>
      <Derived>
        <Round>
          <Switch>
            <!-- SINGLE OR MARRIED FILING SEPARATELY -->
            <Case>
              <When>
                <Any>
                  <Dependency module="filingStatus" path="/isFilingStatusSingle"/>
                  <Dependency module="filingStatus" path="/isFilingStatusMFS"/>
                </Any>
              </When>
              <Then>
                <Switch>
                  <!-- Less than $6,400: no withholding -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>6400</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Dollar>0</Dollar>
                    </Then>
                  </Case>
                  <!-- At least $6,400 but less than $18,325: $0 plus 10% of the excess over $6,400 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>18325</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Multiply>
                        <Rational>10/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../pub15Worksheet1bLine2m"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>6400</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Then>
                  </Case>
                  <!-- At least $18,325 but less than $54,875: $1,192.50 plus 12% of the excess over
            $18,325 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>54875</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>1192.50</Dollar>
                        <Multiply>
                          <Rational>12/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>18325</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $54,875 but less than $109,750: $5,578.50 plus 22% of the excess
                  over $54,875 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>109750</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>5578.50</Dollar>
                        <Multiply>
                          <Rational>22/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>54875</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $109,750 but less than $203,700: $17,651 plus 24% of the excess over
                  $109,750 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>203700</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>17651</Dollar>
                        <Multiply>
                          <Rational>24/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>109750</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $203,700 but less than $256,925: $40,199 plus 32% of the excess over
                  $203,700 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>256925</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>40199</Dollar>
                        <Multiply>
                          <Rational>32/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>203700</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $256,925 but less than $632,750: $57,231 plus 35% of the excess over
                  $256,925 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>632750</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>57231</Dollar>
                        <Multiply>
                          <Rational>35/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>256925</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- $632,750 and above: $188,769.75 plus 37% of the excess over $632,750 -->
                  <Case>
                    <When>
                      <True/>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>188769.75</Dollar>
                        <Multiply>
                          <Rational>37/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>632750</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                </Switch>
              </Then>
            </Case>
            <Case>
              <When>
                <Any>
                  <Dependency module="filingStatus" path="/isFilingStatusMFJ"/>
                  <Dependency module="filingStatus" path="/isFilingStatusQSS"/>
                </Any>
              </When>
              <Then>
                <Switch>
                  <!-- Less than $17,100: no withholding -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>17100</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Dollar>0</Dollar>
                    </Then>
                  </Case>
                  <!-- At least $17,100 but less than $40,950: $0 plus 10% of the excess over
                  $17,100 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>40950</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Multiply>
                        <Rational>10/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../pub15Worksheet1bLine2m"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>17100</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Then>
                  </Case>
                  <!-- At least $40,950 but less than $114,050: $2,385 plus 12% of the excess over
                  $40,950 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>114050</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>2385</Dollar>
                        <Multiply>
                          <Rational>12/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>40950</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $114,050 but less than $223,800: $11,157 plus 22% of the excess over
                  $114,050 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>223800</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>11157</Dollar>
                        <Multiply>
                          <Rational>22/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>114050</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $223,800 but less than $411,700: $35,302 plus 24% of the excess over
                  $223,800 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>411700</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>35302</Dollar>
                        <Multiply>
                          <Rational>24/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>223800</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $411,700 but less than $518,150: $80,398 plus 32% of the excess over
                  $411,700 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>518150</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>80398</Dollar>
                        <Multiply>
                          <Rational>32/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>411700</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $518,150 but less than $768,700: $114,462 plus 35% of the excess
                  over $518,150 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>768700</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>114462</Dollar>
                        <Multiply>
                          <Rational>35/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>518150</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- $768,700 and above: $202,154.50 plus 37% of the excess over $768,700 -->
                  <Case>
                    <When>
                      <True/>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>202154.50</Dollar>
                        <Multiply>
                          <Rational>37/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>768700</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                </Switch>
              </Then>
            </Case>
            <Case>
              <When>
                <Dependency module="filingStatus" path="/isFilingStatusHOH"/>
              </When>
              <Then>
                <Switch>
                  <!-- Less than $13,900: no withholding -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>13900</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Dollar>0</Dollar>
                    </Then>
                  </Case>
                  <!-- At least $13,900 but less than $30,900: $0 plus 10% of the excess over
                  $13,900 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>30900</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Multiply>
                        <Rational>10/100</Rational>
                        <Subtract>
                          <Minuend>
                            <Dependency path="../pub15Worksheet1bLine2m"/>
                          </Minuend>
                          <Subtrahends>
                            <Dollar>13900</Dollar>
                          </Subtrahends>
                        </Subtract>
                      </Multiply>
                    </Then>
                  </Case>
                  <!-- At least $30,900 but less than $78,750: $1,700 plus 12% of the excess over
                  $30,900 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>78750</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>1700</Dollar>
                        <Multiply>
                          <Rational>12/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>30900</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $78,750 but less than $117,250: $7,442 plus 22% of the excess over
                  $78,750 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>117250</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>7442</Dollar>
                        <Multiply>
                          <Rational>22/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>78750</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $117,250 but less than $211,200: $15,912 plus 24% of the excess over
                  $117,250 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>211200</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>15912</Dollar>
                        <Multiply>
                          <Rational>24/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>117250</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $211,200 but less than $264,400: $38,460 plus 32% of the excess over
                  $211,200 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>264400</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>38460</Dollar>
                        <Multiply>
                          <Rational>32/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>211200</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- At least $264,400 but less than $640,250: $55,484 plus 35% of the excess over
                  $264,400 -->
                  <Case>
                    <When>
                      <LessThan>
                        <Left>
                          <Dependency path="../pub15Worksheet1bLine2m"/>
                        </Left>
                        <Right>
                          <Dollar>640250</Dollar>
                        </Right>
                      </LessThan>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>55484</Dollar>
                        <Multiply>
                          <Rational>35/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>264400</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                  <!-- $640,250 and above: $187,031.50 plus 37% of the excess over $640,250 -->
                  <Case>
                    <When>
                      <True/>
                    </When>
                    <Then>
                      <Add>
                        <Dollar>187031.50</Dollar>
                        <Multiply>
                          <Rational>37/100</Rational>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../pub15Worksheet1bLine2m"/>
                            </Minuend>
                            <Subtrahends>
                              <Dollar>640250</Dollar>
                            </Subtrahends>
                          </Subtract>
                        </Multiply>
                      </Add>
                    </Then>
                  </Case>
                </Switch>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/pub15Worksheet1bLine2t">
      <Derived>
        <GreaterOf>
          <Dollar>0</Dollar>
          <Subtract>
            <Minuend>
              <Dependency path="../pub15Worksheet1bLine2s"/>
            </Minuend>
            <Subtrahends>
              <Dependency path="../pub15Worksheet1bLine2j"/>
            </Subtrahends>
          </Subtract>
        </GreaterOf>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/baseAnnualWithholding">
      <Description>
        The tentative annual withholding amount. Pub. 15T Worksheet 1B Line 2u.
      </Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Not>
                <Equal>
                  <Left>
                    <Dependency path="../w4pLine2biii"/>
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </Equal>
              </Not>
            </When>
            <Then>
              <Dependency path="../pub15Worksheet1bLine2t"/>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dependency path="../pub15Worksheet1bLine2j"/>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/basePerPayPeriodWithholding">
      <Derived>
        <Divide>
          <Dividend>
            <Dependency path="../baseAnnualWithholding"/>
          </Dividend>
          <Divisors>
            <Dependency path="../payPeriodsPerYear"/>
          </Divisors>
        </Divide>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/pub15FinalWithholding">
      <Description>
        Line 4c of Pub. 15-T Worksheet 1B. The per-period withholding amount sub credits, excluding
        any extra elected on Form W-4P Line 4(c).
      </Description>
      <Derived>
        <Divide>
          <Dividend>
            <GreaterOf>
              <Subtract>
                <Minuend>
                  <Dependency path="../baseAnnualWithholding"/>
                </Minuend>
                <Subtrahends>
                  <Dependency path="/totalCredits"/>
                </Subtrahends>
              </Subtract>
              <Dollar>0</Dollar>
            </GreaterOf>
          </Dividend>
          <Divisors>
            <Dependency path="../payPeriodsPerYear"/>
          </Divisors>
        </Divide>
      </Derived>
    </Fact>
    <Fact path="/jobsAvailableForExtraWithholding">
      <Description>Jobs that are ended or end too soon are not candidates for extra withholding on a
        new W4.</Description>
      <Derived>
        <!-- TODO: what should we do if no jobs meet this filter? -->
        <Filter path="/jobs">
          <GreaterThan>
            <Left>
              <Dependency path="/jobs/*/remainingPayPeriods"/>
            </Left>
            <Right>
              <Dependency path="/jobs/*/payPeriodsBeforeW4ChangesAppear"/>
            </Right>
          </GreaterThan>
        </Filter>
      </Derived>
    </Fact>
    <Fact path="/jobSelectedForExtraWithholding">
      <Description>The job selected for extra withholding on a new W4. The W4 refers to this as the
        "highest paying job".</Description>
      <Derived>
        <IndexOf>
          <Collection>
            <Filter path="/jobsAvailableForExtraWithholding">
              <Equal>
                <Left>
                  <Maximum>
                    <Dependency path="/jobsAvailableForExtraWithholding/*/restOfYearIncome"/>
                  </Maximum>
                </Left>
                <Right>
                  <Dependency path="restOfYearIncome"/>
                </Right>
              </Equal>
            </Filter>
          </Collection>
          <Index>
            <Int>0</Int>
          </Index>
        </IndexOf>
      </Derived>
    </Fact>
    <Fact path="/totalJobsIncome">
      <Description>Total income for all jobs</Description>
      <Derived>
        <CollectionSum>
          <Dependency path="/jobs/*/income"/>
        </CollectionSum>
      </Derived>
    </Fact>
    <Fact path="/totalYearToDateJobsWithholding">
      <Description>Total actual withholding for all jobs</Description>
      <Derived>
        <CollectionSum>
          <Dependency path="/jobs/*/yearToDateWithholding"/>
        </CollectionSum>
      </Derived>
    </Fact>
    <Fact path="/totalEndOfYearProjectedWithholding">
      <Description>The amount withheld for all jobs if nothing is changed.</Description>
      <Derived>
        <Add>
          <CollectionSum>
            <Dependency path="/jobs/*/endOfYearProjectedWithholding"/>
          </CollectionSum>
          <Dependency path="/pensionsTotalEndOfYearProjectedWithholding"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/withholdingGap">
      <Description>The rest-of-year withholding gap: taxes owed if nothing is changed.</Description>
      <Derived>
        <GreaterOf>
          <Dollar>0</Dollar>
          <Subtract>
            <Minuend>
              <Dependency path="/totalTax"/>
            </Minuend>
            <Subtrahends>
              <Dependency path="/totalEndOfYearProjectedWithholding"/>
            </Subtrahends>
          </Subtract>
        </GreaterOf>
      </Derived>
    </Fact>
    <Fact path="/totalCommittedWithholding">
      <Derived>
        <CollectionSum>
          <Dependency path="/jobs/*/committedWithholding"/>
        </CollectionSum>
      </Derived>
    </Fact>
    <!-- This is a temporary definition, kind of circular with other facts. -->
    <Fact path="/totalNonJobsIncome">
      <Derived>
        <GreaterOf>
          <Dollar>0</Dollar>
          <Subtract>
            <Minuend>
              <Dependency path="/totalIncome"/>
            </Minuend>
            <Subtrahends>
              <Dependency path="/totalJobsIncome"/>
              <Dependency path="/selfEmploymentIncome"/>
            </Subtrahends>
          </Subtract>
        </GreaterOf>
      </Derived>
    </Fact>
    <Fact path="/pensions">
      <Writable>
        <Collection/>
      </Writable>
    </Fact>
    <Fact path="/pensions/*/startDate">
      <Description>
        The start date of the pension this year
      </Description>
      <Writable>
        <Day/>
      </Writable>
    </Fact>
    <Fact path="/pensions/*/endDate">
      <Description>
        The end date of the pension this year
      </Description>
      <Writable>
        <Day/>
      </Writable>
    </Fact>
    <Fact path="/pensions/*/averagePayPerPayPeriod">
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/pensions/*/averageWithholdingPerPayPeriod">
      <Description> Average withholding from a specific pension per pay-period. </Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/pensions/*/yearToDateIncome">
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/pensions/*/income">
      <Derived>
        <Add>
          <Multiply>
            <Dependency path="../averagePayPerPayPeriod"/>
            <Dependency path="../remainingPayDates"/>
          </Multiply>
          <Dependency path="../yearToDateIncome"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/yearToDateWithholding">
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/pensions/*/mostRecentPayDate">
      <Writable>
        <Day/>
      </Writable>
    </Fact>
    <Fact path="/pensions/*/payFrequency">
      <Writable>
        <Enum optionsPath="/payFrequencyOptions"/>
      </Writable>
    </Fact>
    <Fact path="/pensions/*/payPeriodLength">
      <Description>Length of pay periods matching the Floor of Publication 15-T values.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyWeekly"/>
            </When>
            <Then>
              <Int>7</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyBiWeekly"/>
            </When>
            <Then>
              <Int>14</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencySemiMonthly"/>
            </When>
            <Then>
              <Int>15</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyMonthly"/>
            </When>
            <Then>
              <Int>30</Int>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/payPeriodsPerYear">
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyWeekly"/>
            </When>
            <Then>
              <Int>52</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyBiWeekly"/>
            </When>
            <Then>
              <Int>26</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencySemiMonthly"/>
            </When>
            <Then>
              <Int>24</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyMonthly"/>
            </When>
            <Then>
              <Int>12</Int>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/payPeriodsBeforeW4ChangesAppear">
      <Description>This is derived from the "2197 Scenarios checks" worksheet of the
        "TWESprint1_2025_UAT_WHC2197_2200" spreadsheet.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyWeekly"/>
            </When>
            <Then>
              <Int>2</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Any>
                <Dependency path="../isPayFrequencyBiWeekly"/>
                <Dependency path="../isPayFrequencySemiMonthly"/>
              </Any>
            </When>
            <Then>
              <Int>1</Int>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../isPayFrequencyMonthly"/>
            </When>
            <Then>
              <Int>0</Int>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/isPayFrequencyWeekly">
      <Derived>
        <Equal>
          <Left>
            <Dependency path="../payFrequency"/>
          </Left>
          <Right>
            <Enum optionsPath="/payFrequencyOptions">weekly</Enum>
          </Right>
        </Equal>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/isPayFrequencyBiWeekly">
      <Derived>
        <Equal>
          <Left>
            <Dependency path="../payFrequency"/>
          </Left>
          <Right>
            <Enum optionsPath="/payFrequencyOptions">biWeekly</Enum>
          </Right>
        </Equal>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/isPayFrequencySemiMonthly">
      <Derived>
        <Equal>
          <Left>
            <Dependency path="../payFrequency"/>
          </Left>
          <Right>
            <Enum optionsPath="/payFrequencyOptions">semiMonthly</Enum>
          </Right>
        </Equal>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/isPayFrequencyMonthly">
      <Derived>
        <Equal>
          <Left>
            <Dependency path="../payFrequency"/>
          </Left>
          <Right>
            <Enum optionsPath="/payFrequencyOptions">monthly</Enum>
          </Right>
        </Equal>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/remainingPayDates">
      <Description>
        Rough initial calculation for the number of remaining pay dates.
        Works as-is for week-based pay frequencies. Needs further testing and
        modification for month-based.
      </Description>
      <Derived>
        <Floor>
          <Divide>
            <Dividend>
              <Subtract>
                <Minuend>
                  <Dependency path="../endDate/ordinal"/>
                </Minuend>
                <Subtrahends>
                  <Dependency path="../mostRecentPayDate/ordinal"/>
                </Subtrahends>
              </Subtract>
            </Dividend>
            <Divisors>
              <Dependency path="../payPeriodLength"/>
            </Divisors>
          </Divide>
        </Floor>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/restOfYearIncome">
      <Derived>
        <Multiply>
          <Dependency path="../averagePayPerPayPeriod"/>
          <Dependency path="../remainingPayDates"/>
        </Multiply>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/endOfYearProjectedWithholding">
      <Derived>
        <Add>
          <Dependency path="../yearToDateWithholding"/>
          <Multiply>
            <!-- Floor is used here to match QA spreadsheet calculation -->
            <Floor>
              <Dependency path="../remainingPayDates"/>
            </Floor>
            <Dependency path="../averageWithholdingPerPayPeriod"/>
          </Multiply>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/pensions/*/w4pLine4cRecommendation">
      <Derived>
        <Switch>
          <Case>
            <When>
              <All>
                <Equal>
                  <Left>
                    <Dependency path="../w4pLine2bi"/>
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </Equal>
                <!-- And this is the pension selected for highest income -->
                <Equal>
                  <Left>
                    <Dependency path=".."/>
                  </Left>
                  <Right>
                    <Dependency path="/pensionSelectedForExtraWithholding"/>
                  </Right>
                </Equal>
              </All>
            </When>
            <Then>
              <Round>
                <Subtract>
                  <Minuend>
                    <Add>
                      <!-- Divide the gap by the number of pay periods impacted by a new W4. -->
                      <Divide>
                        <Dividend>
                          <Dependency path="/withholdingGap"/>
                        </Dividend>
                        <Divisors>
                          <Subtract>
                            <Minuend>
                              <Dependency path="../remainingPayDates"/>
                            </Minuend>
                            <Subtrahends>
                              <Dependency path="../payPeriodsBeforeW4ChangesAppear"/>
                            </Subtrahends>
                          </Subtract>
                        </Divisors>
                      </Divide>
                      <!-- Add it to their existing rate of withholding. -->
                      <Dependency path="../averageWithholdingPerPayPeriod"/>
                    </Add>
                  </Minuend>
                  <Subtrahends>
                    <!-- Subtract the base withholding from Pub 15-T so we're left with the extra. -->
                    <Dependency path="../basePerPayPeriodWithholding"/>
                  </Subtrahends>
                </Subtract>
              </Round>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/pensionsAvailableForExtraWithholding">
      <Derived>
        <Filter path="/pensions">
          <GreaterThan>
            <Left>
              <Dependency path="/pensions/*/remainingPayDates"/>
            </Left>
            <Right>
              <Dependency path="/pensions/*/payPeriodsBeforeW4ChangesAppear"/>
            </Right>
          </GreaterThan>
        </Filter>
      </Derived>
    </Fact>
    <Fact path="/pensionSelectedForExtraWithholding">
      <Derived>
        <IndexOf>
          <Collection>
            <Filter path="/pensionsAvailableForExtraWithholding">
              <Equal>
                <Left>
                  <Maximum>
                    <Dependency path="/pensionsAvailableForExtraWithholding/*/restOfYearIncome"/>
                  </Maximum>
                </Left>
                <Right>
                  <Dependency path="restOfYearIncome"/>
                </Right>
              </Equal>
            </Filter>
          </Collection>
          <Index>
            <Int>0</Int>
          </Index>
        </IndexOf>
      </Derived>
    </Fact>
    <Fact path="/totalPensionsIncome">
      <Description> Total income from all pensions. </Description>
      <Derived>
        <CollectionSum>
          <Dependency path="/pensions/*/income"/>
        </CollectionSum>
      </Derived>
    </Fact>
    <Fact path="/pensionsTotalEndOfYearProjectedWithholding">
      <Derived>
        <CollectionSum>
          <Dependency path="/pensions/*/endOfYearProjectedWithholding"/>
        </CollectionSum>
      </Derived>
    </Fact>
    <Fact path="/maxNetSelfEmploymentIncomeSubjectToSocialSecurityTax">
      <TaxYear>2025</TaxYear>
      <Derived>
        <Dollar>176100</Dollar>
      </Derived>
    </Fact>
    <Fact path="/netSelfEmploymentIncome">
      <Description>Net self-employment income as reported on line 3 of Schedule SE (Form 1040).</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/selfEmploymentLineBCalculation">
      <Description>Specific calculation on line 5b of Schedule SE (Form 1040) to multiply net self
        employment income by 92.35%.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <GreaterThan>
                <Left>
                  <Multiply>
                    <Dependency path="/netSelfEmploymentIncome"/>
                    <Rational>1847/2000</Rational>
                  </Multiply>
                </Left>
                <Right>
                  <Dollar>100</Dollar>
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <Multiply>
                <Dependency path="/netSelfEmploymentIncome"/>
                <Rational>1847/2000</Rational>
              </Multiply>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/taxableSelfEmploymentIncome">
      <Description>Taxable self-employment income from lines 4-5 on Schedule SE (Form 1040).</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <GreaterThan>
                <Left>
                  <Dependency path="/netSelfEmploymentIncome"/>
                </Left>
                <Right>
                  <Dependency path="/maxNetSelfEmploymentIncomeSubjectToSocialSecurityTax"/>
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <LesserOf>
                <Dependency path="/maxNetSelfEmploymentIncomeSubjectToSocialSecurityTax"/>
                <Dependency path="/selfEmploymentLineBCalculation"/>
              </LesserOf>
            </Then>
          </Case>
          <Case>
            <When>
              <LessThan>
                <Left>
                  <Dependency path="/netSelfEmploymentIncome"/>
                </Left>
                <Right>
                  <Dollar>400</Dollar>
                </Right>
              </LessThan>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dependency path="/selfEmploymentLineBCalculation"/>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/socialSecuritySelfEmploymentTax">
      <Description>Self-employment tax multiplied by the Social Security tax rate from line 10 on
        Schedule SE (Form 1040).</Description>
      <Derived>
        <Multiply>
          <Dependency path="/taxableSelfEmploymentIncome"/>
          <Rational>31/250</Rational>
        </Multiply>
      </Derived>
    </Fact>
    <Fact path="/medicareSelfEmploymentTax">
      <Description>Self-employment tax multiplied by the Medicare tax rate from line 11 on Schedule
        SE (Form 1040).</Description>
      <Derived>
        <Multiply>
          <Dependency path="/taxableSelfEmploymentIncome"/>
          <Rational>29/1000</Rational>
        </Multiply>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentTax">
      <Description>Self-employment tax instructions from line 12 on Schedule SE (Form 1040).</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <GreaterThan>
                <Left>
                  <Dependency path="/taxableSelfEmploymentIncome"/>
                </Left>
                <Right>
                  <Dollar>0</Dollar>
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <Add>
                <Dependency path="/socialSecuritySelfEmploymentTax"/>
                <Dependency path="/medicareSelfEmploymentTax"/>
              </Add>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/ordinaryDividendsIncome">
      <Description>Ordinary dividends income</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/unemploymentInsuranceIncome">
      <Description>Unemployment insurance income</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/interestExcludingNonTaxableIncome">
      <Description>Interest income excluding non-taxable interest</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/shortTermCapitalGainsIncome">
      <Description>Short term capital gains income</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/longTermCapitalGainsIncome">
      <Description>Long term capital gains income</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/qualifiedDividendsIncome">
      <Description>Amount of qualified dividends estimated by tax payer.</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/taxableScholarshipIncome">
      <Description>Taxable income from scholarships</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/alimonyReceivedIncome">
      <Description>Alimony received income</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/sCorpNonPassiveIncome">
      <Description>S-corp non-passive income (Schedule K1)</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/netScheduleEIncome">
      <Description>Net Schedule E income</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/nonSpecificOtherIncome">
      <Description>Non-specific other income</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/socialSecuityBenefitsIncome">
      <Description>SSA Income from forms SSA-1099 and RRB-1099</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/nonTaxableInterestIncome">
      <Description>Non-taxable interest income. Used to calculate modified AGI for calculating
        taxable amount of SSA benefits</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/magiForSSABenefitsTaxableAmount">
      <Description>Modifed AGI used to determine taxable amount of SSA benefits. Based on IRS Pub
        915 Worksheet 1</Description>
      <Derived>
        <Add>
          <!-- half of the total SSA benefits received -->
          <Multiply>
            <Dependency path="/socialSecuityBenefitsIncome"/>
            <Rational>50/100</Rational>
          </Multiply>
          <!-- gross income -->
          <Dependency module="taxCalculations" path="/agi"/>
          <!-- non-taxable interest -->
          <Dependency path="/nonTaxableInterestIncome"/>
          <!-- all adjustments are already deducted from AGI, bring back student loan interest
          amount -->
          <Dependency module="adjustments" path="/actualStudentLoanInterestAdjustmentAmount"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/trumpAccountDistribution">
      <Name>OB3 70204: Distribution from Trump Account as defined by IRC 530A</Name>
      <Description> The term "Trump account" means an individual retirement account (as defined in
        section 408(a)) which is not
        designated as a Roth IRA and which meets certain investment requirements</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/totalOtherIncome">
      <Derived>
        <Add>
          <Dependency path="/netSelfEmploymentIncome"/>
          <Dependency path="/ordinaryDividendsIncome"/>
          <Dependency path="/unemploymentInsuranceIncome"/>
          <Dependency path="/interestExcludingNonTaxableIncome"/>
          <Dependency path="/shortTermCapitalGainsIncome"/>
          <Dependency path="/longTermCapitalGainsIncome"/>
          <Dependency path="/taxableScholarshipIncome"/>
          <Dependency path="/alimonyReceivedIncome"/>
          <Dependency path="/sCorpNonPassiveIncome"/>
          <Dependency path="/netScheduleEIncome"/>
          <Dependency path="/nonSpecificOtherIncome"/>
          <Dependency path="/trumpAccountDistribution"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/totalIncome">
      <Derived>
        <Round>
          <Add>
            <Dependency path="/totalJobsIncome"/>
            <Dependency path="/totalPensionsIncome"/>
            <Dependency path="/totalOtherIncome"/>
          </Add>
        </Round>
      </Derived>
    </Fact>
    <!-- Sections 911, 931, and 933 are carved out for OB3 MAGI calculations for senior deduction
    and car loan interest deduction
         Default to 0 for right now-->
    <Fact path="/foreignEarnedIncome">
      <Name>&#xA7; 911 Foreign Earned Income Exclusion- Foreign Earned Income</Name>
      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>
    <Fact path="/overseasTerritoryIncome">
      <Name>&#xA7; 931 - Income from sources within Guam, American Samoa, or the Northern Mariana
        Islands
      </Name>
      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>
    <Fact path="/puertoRicoEarnedIncome">
      <Name>&#xA7; 933. Income from sources within Puerto Rico</Name>
      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>
    <Fact path="/qualifiedTipIncome">
      <Name>Qualified Tip Income</Name>
      <Description>OB3 &#xA7;70201; IRC &#xA7;224. Qualified tip income</Description>
      <Writable>
        <Dollar/>
      </Writable>
      <Placeholder>
        <Dollar>0</Dollar>
      </Placeholder>
    </Fact>
    <Fact path="/overtimeCompensationExcludingQualifiedTipsOvertimeComp">
      <Name>Overtime Compensation Excluding Qualified Tip Overtime Comp</Name>
      <Description>OB3 &#xA7;70202 IRC &#xA7;225(c)(2). Overtime compensation excluding all
        qualified tips
        defined
        in IRC &#xA7;224 that were received as part of qualified overtime compensation</Description>
      <Writable>
        <Dollar/>
      </Writable>
      <Placeholder>
        <Dollar>0</Dollar>
      </Placeholder>
    </Fact>
    <Fact path="/selfEmploymentIncome">
      <Name>Self Employment Income</Name>
      <Writable>
        <Dollar/>
      </Writable>
      <Placeholder>
        <Dollar>0</Dollar>
      </Placeholder>
    </Fact>
    <Fact path="/incomeToIncludeForOB3MAGI">
      <Derived>
        <Add>
          <Dependency path="/foreignEarnedIncome"/>
          <Dependency path="/overseasTerritoryIncome"/>
          <Dependency path="/puertoRicoEarnedIncome"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/nextPayDayForSemiMonthlyCalculations">
      <Description>For semimonthly pay calculate the second pay date, based on the provided day when
        the most recent pay period ended. Example: last pay day is 18th, then the other pay day of
        the month will fall on 3rd.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <GreaterThan>
                <Left>
                  <Dependency path="../mostRecentPayPeriodEnd/day"/>
                </Left>
                <Right>
                  <Int>15</Int>
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <Subtract>
                <Minuend>
                  <Dependency path="../mostRecentPayPeriodEnd/day"/>
                </Minuend>
                <Subtrahends>
                  <Int>15</Int>
                </Subtrahends>
              </Subtract>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Add>
                <Dependency path="../mostRecentPayPeriodEnd/day"/>
                <Int>15</Int>
              </Add>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/latestPayDateForSemimonthlyCalculations">
      <Description>For semimonthly pay determine which one of two monthly pay days is later.
        Example: pay days are 5 and 20. Use 20 for diff calculation</Description>
      <Derived>
        <GreaterOf>
          <Dependency path="../mostRecentPayPeriodEnd/day"/>
          <Dependency path="../nextPayDayForSemiMonthlyCalculations"/>
        </GreaterOf>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/closestPayDateForSemimonthlyCalculations">
      <Description>For semimonthly pay determine which one of two monthly pay days is earlier than a
        end date. Example: pay days are 5 and 20. End day is 15. Use 5 for diff calculation.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <GreaterThan>
                <Left>
                  <Dependency path="../endDayForSemiMonthlyCalculations"/>
                </Left>
                <Right>
                  <Dependency path="../nextPayDayForSemiMonthlyCalculations"/>
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <Dependency path="../mostRecentPayPeriodEnd/day"/>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dependency path="../nextPayDayForSemiMonthlyCalculations"/>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/jobs/*/diffBetweenLastPayDateAndEndDate">
      <Description>For semimonthly pay calculate diff between the last pay date and the end date</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <!-- End day is after both pay days. Example: pay days are 5, 20. End day is 30.
              Use 20 for diff calc -->
              <All>
                <GreaterThanOrEqual>
                  <Left>
                    <Dependency path="../endDayForSemiMonthlyCalculations"/>
                  </Left>
                  <Right>
                    <Dependency path="../mostRecentPayPeriodEnd/day"/>
                  </Right>
                </GreaterThanOrEqual>
                <GreaterThanOrEqual>
                  <Left>
                    <Dependency path="../endDayForSemiMonthlyCalculations"/>
                  </Left>
                  <Right>
                    <Dependency path="../nextPayDayForSemiMonthlyCalculations"/>
                  </Right>
                </GreaterThanOrEqual>
              </All>
            </When>
            <Then>
              <!-- Use latest pay date for diff calculation -->
              <Subtract>
                <Minuend>
                  <Dependency path="../endDayForSemiMonthlyCalculations"/>
                </Minuend>
                <Subtrahends>
                  <Dependency path="../latestPayDateForSemimonthlyCalculations"/>
                </Subtrahends>
              </Subtract>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <!-- Use pay date before the end date. Example: pay days are 5, 20. End day is 15. Use
              5 for diff calc -->
              <Subtract>
                <Minuend>
                  <Dependency path="../endDayForSemiMonthlyCalculations"/>
                </Minuend>
                <Subtrahends>
                  <Dependency path="../closestPayDateForSemimonthlyCalculations"/>
                </Subtrahends>
              </Subtract>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
  </Facts>
</FactDictionaryModule>
