<?xml version="1.0"?>
<?xml-model href="./FactDictionaryModule.rng"?>
<FactDictionaryModule>
  <Facts>
    <Fact path="/netSelfEmploymentIncomeTotal">
      <Derived>
        <Add>
          <Dependency path="/netSelfEmploymentIncomeSelf"/>
          <Dependency path="/netSelfEmploymentIncomeSpouse"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/netSelfEmploymentIncomeSelf">
      <Description>Net profit loss, reported as Line 31 on Schedule C and line 2 of Schedule SE for self.</Description>
      <Derived>
        <Subtract>
          <Minuend>
            <Dependency path="/grossSelfEmploymentIncomeSelf"/>
          </Minuend>
          <Subtrahends>
            <Dependency path="/selfEmploymentIncomeExpensesSelf"/>
          </Subtrahends>
        </Subtract>
      </Derived>
    </Fact>
    <Fact path="/netSelfEmploymentIncomeSpouse">
      <Description>Net profit loss, reported as Line 31 on Schedule C and line 2 of Schedule SE for spouse.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <All>
                <Dependency path="/isFilingStatusMFJ"/>
                <IsComplete>
                  <Dependency path="/grossSelfEmploymentIncomeSpouse"/>
                </IsComplete>
              </All>
            </When>
            <Then>
              <Subtract>
                <Minuend>
                  <Dependency path="/grossSelfEmploymentIncomeSpouse"/>
                </Minuend>
                <Subtrahends>
                  <Dependency path="/selfEmploymentIncomeExpensesSpouse"/>
                </Subtrahends>
              </Subtract>
            </Then>
          </Case>
          <Case>
            <When>
              <All>
                <Dependency path="/isFilingStatusMFJ"/>
                <Not>
                  <IsComplete>
                    <Dependency path="/grossSelfEmploymentIncomeSpouse"/>
                  </IsComplete>
                </Not>
              </All>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/socialSecuritySelfEmploymentTaxPortion">
      <Derived>
        <Rational>31/250</Rational>
      </Derived>
    </Fact>
    <Fact path="/medicareSelfEmploymentTaxPortion">
      <Derived>
        <Rational>29/1000</Rational>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentTaxDeductionMultiplier">
      <Derived>
        <Rational>1/2</Rational>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine4aLine5bMultiplier">
      <Derived>
        <Rational>1847/2000</Rational>
      </Derived>
    </Fact>
    <Fact path="/maxNetSelfEmploymentIncomeSubjectToSocialSecurityTax">
      <Description> Schedule SE Line 7. Maximum amount of combined wages and self-employment earnings subject to social security tax or
        the 6.2% portion of the 7.65% railroad retirement (tier 1) tax for 2025</Description>
      <TaxYear>2025</TaxYear>
      <Derived>
        <Dollar>176100</Dollar>
      </Derived>
    </Fact>
    <Fact path="/primaryHasSelfEmploymentIncome">
      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="/netSelfEmploymentIncomeSelf"/>
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>
    <Fact path="/secondaryHasSelfEmploymentIncome">
      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="/netSelfEmploymentIncomeSpouse"/>
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>
    <Fact path="/eitherTPHasSelfEmploymentIncome">
      <Derived>
        <Any>
          <Dependency path="/primaryHasSelfEmploymentIncome"/>
          <Dependency path="/secondaryHasSelfEmploymentIncome"/>
        </Any>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine2Self">
      <Derived>
        <Dependency path="/netSelfEmploymentIncomeSelf"/>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine4aSelf">
      <Description>Specific calculation on line 4a of Schedule SE (Form 1040) to multiply net self
        employment income by 92.35%.</Description>
      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <GreaterThan>
                  <Left>
                    <Dependency path="/scheduleSELine2Self"/>
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </When>
              <Then>
                <Multiply>
                  <Dependency path="/netSelfEmploymentIncomeSelf"/>
                  <Dependency path="/scheduleSELine4aLine5bMultiplier"/>
                </Multiply>
              </Then>
            </Case>
            <Case>
              <When>
                <True/>
              </When>
              <Then>
                <Dependency path="/netSelfEmploymentIncomeSelf"/>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine4bSelf">
      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine4cSelf">
      <Description>Combine lines 4a and 4b. If less than $400, 0 and no self-employment tax.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <GreaterThan>
                <Left>
                  <Add>
                    <Dependency path="/scheduleSELine4aSelf"/>
                    <Dependency path="/scheduleSELine4bSelf"/>
                  </Add>
                </Left>
                <Right>
                  <Dollar>400</Dollar>
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <Add>
                <Dependency path="/scheduleSELine4aSelf"/>
                <Dependency path="/scheduleSELine4bSelf"/>
              </Add>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine5aSelf">
      <Description>5a) Enter your church employee income from Form W-2. See instructions for definition of church employee income. </Description>
      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine5bSelf">
      <Description>5b) Multiply line 5a by 92.35% (0.9235). If less than $100, enter -0- </Description>
      <Derived>
        <Multiply>
          <Dependency path="/scheduleSELine5aSelf"/>
          <Dependency path="/scheduleSELine4aLine5bMultiplier"/>
        </Multiply>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine6Self">
      <Description>Line 4c + Line 5b </Description>
      <Derived>
        <Add>
          <Dependency path="/scheduleSELine4cSelf"/>
          <Dependency path="/scheduleSELine5bSelf"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine8dSelf">
      <Description>
        Sum of 8a + 8b + 8c
        8a) Total social security wages and tips (total of boxes 3 and 7 on Form(s) W-2) and railroad retirement (tier 1) compensation.
        8b) Unreported tips subject to social security tax from Form 4137, line 10
        8c) Wages subject to social security tax from Form 8919, line 10
      </Description>
      <Derived>
        <!--        TODO: Confirm that this is the right aggregate fact, update once we split out income by self and spouse-->
        <Dependency path="/totalJobsIncome"/>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine9Self">
      <Description>
        Greater of zero or Line 7 - Line 8d
      </Description>
      <Derived>
        <GreaterOf>
          <Subtract>
            <Minuend>
              <Dependency path="/maxNetSelfEmploymentIncomeSubjectToSocialSecurityTax"/>
            </Minuend>
            <Subtrahends>
              <Dependency path="/scheduleSELine8dSelf"/>
            </Subtrahends>
          </Subtract>
          <Dollar>0</Dollar>
        </GreaterOf>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine10Self">
      <Description>Self-employment tax multiplied by the Social Security tax rate from line 10 on
        Schedule SE (Form 1040).
        12.4 * MIN(line6,line9)
      </Description>
      <Derived>
        <Round>
          <Multiply>
            <LesserOf>
              <Dependency path="/scheduleSELine6Self"/>
              <Dependency path="/scheduleSELine9Self"/>
            </LesserOf>
            <Dependency path="/socialSecuritySelfEmploymentTaxPortion"/>
          </Multiply>
        </Round>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine11Self">
      <Description>Line 10 *2.9%  (medicare self employment tax portion)
      </Description>
      <Derived>
        <Round>
          <Multiply>
            <Dependency path="/scheduleSELine6Self"/>
            <Dependency path="/medicareSelfEmploymentTaxPortion"/>
          </Multiply>
        </Round>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine12Self">
      <Description>Self employment tax (line 10 + line 11)
        Enter here and on Schedule 2 (Form 1040), line 4, or Form 1040-SS, Part I, line 3 </Description>
      <Derived>
        <Add>
          <Dependency path="/scheduleSELine10Self"/>
          <Dependency path="/scheduleSELine11Self"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine13Self">
      <Description>Self Employment Tax Deduction. Multiply line 12 by 50% (0.50). Schedule SE line 13, Schedule 1 (Form 1040), line 15</Description>
      <Derived>
        <Round>
          <Multiply>
            <Dependency path="/scheduleSELine12Self"/>
            <Dependency path="/selfEmploymentTaxDeductionMultiplier"/>
          </Multiply>
        </Round>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine2Spouse">
      <Derived>
        <Dependency path="/netSelfEmploymentIncomeSpouse"/>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine4aSpouse">
      <Description>Specific calculation on line 4a of Schedule SE (Form 1040) to multiply net self
        employment income by 92.35%.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <GreaterThan>
                <Left>
                  <Dependency path="/netSelfEmploymentIncomeSpouse"/>
                </Left>
                <Right>
                  <Dollar>0</Dollar>
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <Multiply>
                <Dependency path="/netSelfEmploymentIncomeSpouse"/>
                <Dependency path="/scheduleSELine4aLine5bMultiplier"/>
              </Multiply>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dependency path="/netSelfEmploymentIncomeSpouse"/>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine4bSpouse">
      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine4cSpouse">
      <Description>Combine lines 4a and 4b. If less than $400, 0 and no self-employment tax.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <GreaterThan>
                <Left>
                  <Add>
                    <Dependency path="/scheduleSELine4aSpouse"/>
                    <Dependency path="/scheduleSELine4bSpouse"/>
                  </Add>
                </Left>
                <Right>
                  <Dollar>400</Dollar>
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <Add>
                <Dependency path="/scheduleSELine4aSpouse"/>
                <Dependency path="/scheduleSELine4bSpouse"/>
              </Add>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine5aSpouse">
      <Description>5a) Enter your church employee income from Form W-2. See instructions for definition of church employee income. </Description>
      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine5bSpouse">
      <Description>5b) Multiply line 5a by 92.35% (0.9235). If less than $100, enter -0- </Description>
      <Derived>
        <Multiply>
          <Dependency path="/scheduleSELine5aSpouse"/>
          <Dependency path="/scheduleSELine4aLine5bMultiplier"/>
        </Multiply>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine6Spouse">
      <Description>Add line 4c and 5b for spouse</Description>
      <Derived>
        <Add>
          <Dependency path="/scheduleSELine4cSpouse"/>
          <Dependency path="/scheduleSELine5bSpouse"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine8dSpouse">
      <Description>
        Sum of 8a + 8b + 8c
        8a) Total social security wages and tips (total of boxes 3 and 7 on Form(s) W-2) and railroad retirement (tier 1) compensation.
        8b) Unreported tips subject to social security tax from Form 4137, line 10
        8c) Wages subject to social security tax from Form 8919, line 10
      </Description>
      <Derived>
        <!--        TODO: CHANGE TO SPOUSAL VERSION + Confirm that this is the right aggregate fact, update once we split out income by self and spouse-->
        <Dependency path="/totalJobsIncome"/>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine9Spouse">
      <Description>
        Greater of zero or Line 7 - Line 8d
      </Description>
      <Derived>
        <GreaterOf>
          <Subtract>
            <Minuend>
              <Dependency path="/maxNetSelfEmploymentIncomeSubjectToSocialSecurityTax"/>
            </Minuend>
            <Subtrahends>
              <Dependency path="/scheduleSELine8dSpouse"/>
            </Subtrahends>
          </Subtract>
          <Dollar>0</Dollar>
        </GreaterOf>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine10Spouse">
      <Description>Self-employment tax multiplied by the Social Security tax rate from line 10 on
        Schedule SE (Form 1040).
        12.4 * MIN(line6,line9)
      </Description>
      <Derived>
        <Round>
          <Multiply>
            <LesserOf>
              <Dependency path="/scheduleSELine6Spouse"/>
              <Dependency path="/scheduleSELine9Spouse"/>
            </LesserOf>
            <Dependency path="/socialSecuritySelfEmploymentTaxPortion"/>
          </Multiply>
        </Round>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine11Spouse">
      <Description>Line 10 *2.9%  (medicare self employment tax portion)
      </Description>
      <Derived>
        <Round>
          <Multiply>
            <Dependency path="/scheduleSELine6Spouse"/>
            <Dependency path="/medicareSelfEmploymentTaxPortion"/>
          </Multiply>
        </Round>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine12Spouse">
      <Description>Self employment tax (line 10 + line 11)
        Enter here and on Schedule 2 (Form 1040), line 4, or Form 1040-SS, Part I, line 3 </Description>
      <Derived>
        <Round>
          <Add>
            <Dependency path="/scheduleSELine10Spouse"/>
            <Dependency path="/scheduleSELine11Spouse"/>
          </Add>
        </Round>
      </Derived>
    </Fact>
    <Fact path="/scheduleSELine13Spouse">
      <Description>Self Employment Tax Deduction. Multiply line 12 by 50% (0.50). Schedule SE line 13, Schedule 1 (Form 1040), line 15</Description>
      <Derived>
        <Round>
          <Multiply>
            <Dependency path="/scheduleSELine12Spouse"/>
            <Dependency path="/selfEmploymentTaxDeductionMultiplier"/>
          </Multiply>
        </Round>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentTax">
      <Description>Self employment tax combined for both self and spouse. Entered on Schedule 2 line 4 and Form 1040-SS Part I, line 3</Description>
      <Derived>
        <Add>
          <Dependency path="/scheduleSELine12Self"/>
          <Dependency path="/scheduleSELine12Spouse"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentTaxDeduction">
      <Description>Self Employment Tax Deduction combined for both self and spouse</Description>
      <Derived>
        <Add>
          <Dependency path="/scheduleSELine13Self"/>
          <Dependency path="/scheduleSELine13Spouse"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentHealthInsuranceDeductionForm7206Line1">
      <Description>Total amount paid in 2024 for health insurance coverage established under your business(or the S corporation in which you were a more-than-2% shareholder) for 2024 for you, your spouse,and your dependents.
        Excludes:
        1) Amounts for any month you were eligible to participate in a health plan subsidized by your employer or your spouse&#x2019;s employer or the employer of either your dependent or your child who was under the age of 27 at the end of 2024.
        2) Any amounts paid, not to exceed $3,000, from retirement plan distributions that were non taxablebecause you are a retired public safety officer.
        3) Any payments for qualified long-term care insurance (see line 2)</Description>
      <Derived>
        <Dependency path="/selfEmploymentHealthInsuranceContributions"/>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentHealthInsuranceDeductionForm7206Line2">
      <Description>Qualified long-term care insurance contract payments or premiums. Included in Line 1 per content</Description>
      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentHealthInsuranceDeductionForm7206Line3">
      <Description>Total SE health insurance and long term care premiums </Description>
      <Derived>
        <Add>
          <Dependency path="/selfEmploymentHealthInsuranceDeductionForm7206Line1"/>
          <Dependency path="/selfEmploymentHealthInsuranceDeductionForm7206Line2"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentHealthInsuranceDeductionForm7206Line4">
      <Description>Net profit and any other earned income from the trade or business under which the insurance plan is established. Don&#x2019;t include Conservation Reserve Program payments exempt from self-employment tax. </Description>
      <Derived>
        <GreaterOf>
          <Add>
            <Dependency path="/scheduleSELine2Self"/>
            <Dependency path="/scheduleSELine2Spouse"/>
          </Add>
          <Dollar>0</Dollar>
        </GreaterOf>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentHealthInsuranceDeductionForm7206Line5">
      <Description>Schedule C line 31, Schedule SE line 2. Total net profit of self-employment income combined for both self and spouse </Description>
      <Derived>
        <GreaterOf>
          <Add>
            <Dependency path="/scheduleSELine2Self"/>
            <Dependency path="/scheduleSELine2Spouse"/>
          </Add>
          <Dollar>0</Dollar>
        </GreaterOf>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentHealthInsuranceDeductionForm7206Line6">
      <Description>Percentage of profit allocated to the business under which the insurance plan is established</Description>
      <Derived>
        <Divide>
          <Dividend>
            <Dependency path="/selfEmploymentHealthInsuranceDeductionForm7206Line4"/>
          </Dividend>
          <Divisors>
            <Dependency path="/selfEmploymentHealthInsuranceDeductionForm7206Line5"/>
          </Divisors>
        </Divide>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentHealthInsuranceDeductionForm7206Line7">
      <Description>Line 6 multiplied by deductible portion of SE tax</Description>
      <Derived>
        <Multiply>
          <Dependency path="/selfEmploymentTaxDeduction"/>
          <Dependency path="/selfEmploymentHealthInsuranceDeductionForm7206Line6"/>
        </Multiply>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentHealthInsuranceDeductionForm7206Line8">
      <Description>Net profit - applicable portion of SE tax deduction</Description>
      <Derived>
        <Subtract>
          <Minuend>
            <Dependency path="/selfEmploymentHealthInsuranceDeductionForm7206Line4"/>
          </Minuend>
          <Subtrahends>
            <Dependency path="/selfEmploymentHealthInsuranceDeductionForm7206Line7"/>
          </Subtrahends>
        </Subtract>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentHealthInsuranceDeductionForm7206Line9">
      <Description>SE SEP SIMPLE or qualified plans under the insurance plan is established</Description>
      <Derived>
        <Dependency path="/actualSelfEmployedRetirementPlanDeduction"/>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentHealthInsuranceDeductionForm7206Line10">
      <Derived>
        <Subtract>
          <Minuend>
            <Dependency path="/selfEmploymentHealthInsuranceDeductionForm7206Line8"/>
          </Minuend>
          <Subtrahends>
            <Dependency path="/selfEmploymentHealthInsuranceDeductionForm7206Line9"/>
          </Subtrahends>
        </Subtract>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentHealthInsuranceDeductionForm7206Line11">
      <Description>Medicare wages from an S corp in which you are &gt;2% shareholder in which the insurance plan is established</Description>
      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentHealthInsuranceDeductionForm7206Line12">
      <Description>Form 2555, line 45</Description>
      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentHealthInsuranceDeductionForm7206Line13">
      <Description>Medicare wages from an S corp in which you are &gt;2% shareholder in which the insurance plan is established</Description>
      <Derived>
        <Subtract>
          <Minuend>
            <Dependency path="/selfEmploymentHealthInsuranceDeductionForm7206Line10"/>
          </Minuend>
          <Subtrahends>
            <Dependency path="/selfEmploymentHealthInsuranceDeductionForm7206Line12"/>
          </Subtrahends>
        </Subtract>
      </Derived>
    </Fact>
    <Fact path="/selfEmploymentHealthInsuranceDeductionForm7206Line14">
      <Description>Final self employment health insurance deduction amount</Description>
      <Derived>
        <LesserOf>
          <Dependency path="/selfEmploymentHealthInsuranceDeductionForm7206Line3"/>
          <Dependency path="/selfEmploymentHealthInsuranceDeductionForm7206Line13"/>
        </LesserOf>
      </Derived>
    </Fact>
    <Fact path="/actualSelfEmploymentHealthInsuranceDeduction">
      <Description>Form 7206 line 14. Self-employed health insurance deduction.</Description>
      <Derived>
        <Dependency path="/selfEmploymentHealthInsuranceDeductionForm7206Line14"/>
      </Derived>
    </Fact>
    <Fact path="/actualSelfEmployedRetirementPlanDeduction">
      <Description>Self-employed retirement plan deduction. SEP SIMPLE or other qualified plan
        (Schedule C net profit - deductible portion of SE tax) x (plan contribution rate/ 100% + plan contribution rate)
        Because we don't know what the plan contribution rate is, for all intents and purposes, the max SE retirement plan deduction is
        net self-employment profit - SE tax deduction
        https://www.irs.gov/retirement-plans/self-employed-individuals-calculating-your-own-retirement-plan-contribution-and-deduction
      </Description>
      <Derived>
        <LesserOf>
          <Dependency path="/selfEmployedRetirementPlanContributions"/>
          <Subtract>
            <Minuend>
              <Dependency path="/netSelfEmploymentIncomeTotal"/>
            </Minuend>
            <Subtrahends>
              <Dependency path="/selfEmploymentTaxDeduction"/>
            </Subtrahends>
          </Subtract>
        </LesserOf>
      </Derived>
    </Fact>
  </Facts>
</FactDictionaryModule>
