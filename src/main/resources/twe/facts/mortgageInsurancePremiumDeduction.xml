<?xml version="1.0"?>
<?xml-model href="./FactDictionaryModule.rng"?>
<FactDictionaryModule>
  <Facts>
    <Fact path="/qualifiedMortgageInsurancePremiumPhaseInLimit">
      <TaxYear>2026</TaxYear>
      <Derived>
        <Dollar>100000</Dollar>
      </Derived>
    </Fact>
    <Fact path="/qualifiedMortgageInsurancePremiumPhaseOutRate">
      <TaxYear>2026</TaxYear>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="/isFilingStatusMFS"/>
            </When>
            <Then>
              <!--              $1 for every $500 in AGI-->
              <Dollar>500</Dollar>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <!--              $1 for every $1000 in AGI-->
              <Dollar>1000</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/qualifiedMortgageInsurancePremiumPhaseInThreshold">
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="/isFilingStatusMFS"/>
            </When>
            <Then>
              <Divide>
                <Dividend>
                  <Dependency path="/qualifiedMortgageInsurancePremiumPhaseInLimit"/>
                </Dividend>
                <Divisors>
                  <Int>2</Int>
                </Divisors>
              </Divide>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dependency path="/qualifiedMortgageInsurancePremiumPhaseInLimit"/>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/qualifiedMortgageInsurancePremiumExcessOverThreshold">
      <Derived>
        <GreaterOf>
          <Dollar>0</Dollar>
          <Subtract>
            <Minuend>
              <Dependency path="/agi"/>
            </Minuend>
            <Subtrahends>
              <Dependency path="/qualifiedMortgageInsurancePremiumPhaseInThreshold"/>
            </Subtrahends>
          </Subtract>
        </GreaterOf>
      </Derived>
    </Fact>
    <Fact path="/qualifiedMortgageInsurancePremiumPhaseOutMultiplier">
      <Derived>
        <Ceiling>
          <Divide>
            <Dividend>
              <Dependency path="/qualifiedMortgageInsurancePremiumExcessOverThreshold"/>
            </Dividend>
            <Divisors>
              <Dependency path="/qualifiedMortgageInsurancePremiumPhaseOutRate"/>
            </Divisors>
          </Divide>
        </Ceiling>
      </Derived>
    </Fact>
    <Fact path="/qualifiedMortgageInsurancePremiumReductionRate">
      <Derived>
        <Divide>
          <Dividend>
            <Dependency path="/qualifiedMortgageInsurancePremiumPhaseOutMultiplier"/>
          </Dividend>
          <Divisors>
            <Dollar>10</Dollar>
          </Divisors>
        </Divide>
      </Derived>
    </Fact>
    <Fact path="/qualifiedMortgageInsurancePremiumPhaseOut">
      <Derived>
        <GreaterOf>
          <Dollar>0</Dollar>
          <LesserOf>
            <Dollar>1</Dollar>
            <Dependency path="/qualifiedMortgageInsurancePremiumReductionRate"/>
          </LesserOf>
        </GreaterOf>
      </Derived>
    </Fact>
    <Fact path="/qualifiedMortgageInsurancePremiumDeductionTotal">
      <Description>
        Calculates the final deductible PMI after applying the phaseout percentage to the total premiums paid.
      </Description>
      <Derived>
        <GreaterOf>
          <Dollar>0</Dollar>
          <Multiply>
            <Dependency path="/qualifiedMortgageInsurancePremiums"/>
            <Subtract>
              <Minuend>
                <Dollar>1.00</Dollar>
              </Minuend>
              <Subtrahends>
                <Dependency path="/qualifiedMortgageInsurancePremiumPhaseOut"/>
              </Subtrahends>
            </Subtract>
          </Multiply>
        </GreaterOf>
      </Derived>
    </Fact>
  </Facts>
</FactDictionaryModule>
