<?xml version="1.0"?>
<?xml-model href="./FactDictionaryModule.rng"?>
<FactDictionaryModule>
  <Facts>
    <Fact path="/itemizedDeduction">
      <Name>Itemized deductions</Name>
      <Description>Total amount of itemized deductions minus 2/37 of the excess taxable income of
        the top tax bracket. For taxpayers not in that bracket, the excess will be $0.
        estimated itemized deductions</Description>
      <Derived>
        <Subtract>
          <Minuend>
            <Dependency path="/itemizedDeductionTotal"/>
          </Minuend>
          <Subtrahends>
            <Dependency path="/amountOfItemizedDeductionsToSubtract"/>
          </Subtrahends>
        </Subtract>
      </Derived>
    </Fact>
    <Fact path="/itemizedDeductionTotal">
      <Name>Total amount of itemized deductions</Name>
      <Description>Total amount of itemized deductions that the taxpayer estimates for this tax
        year. There are edge cases for taxpayers in the highest tax bracket that must apply before
        we calculate the final amount of itemized deductions</Description>
      <Derived>
        <Add>
          <Dependency path="/qualifiedMortgageInterestAndInvestmentInterestExpensesTotal"/>
          <Dependency path="/stateAndLocalTaxPaymentsTotal"/>
          <Dependency path="/medicalAndDentalExpensesTotal"/>
          <Dependency path="/charitableContributionsTotal"/>
          <Dependency path="/casualtyLossesTotal"/>
          <Dependency path="/otherDeductionsTotal"/>
        </Add>
      </Derived>
    </Fact>
    <Fact path="/amountOfItemizedDeductionsToSubtract">
      <Description>OB3 70111 adding: IRC Section 68:
        (a) In general In the case of an individual, the
        amount of the itemized deductions otherwise allowable for the taxable year (determined
        without regard to this section) shall be reduced by 2&#x2044;37 of the lesser of
        (1) such amount of
        itemized deductions, or
        (2) so much of the taxable income of the taxpayer for the taxable
        year (determined without regard to this section and increased by such amount of itemized
        deductions) as exceeds the dollar amount at which the 37 percent rate bracket under section
        1 begins with respect to the taxpayer.</Description>
      <Derived>
        <Round>
          <GreaterOf>
            <Dollar>0</Dollar>
            <Multiply>
              <LesserOf>
                <Dependency path="/excessTaxableIncomeOverTopTaxRate"/>
                <Dependency path="/itemizedDeductionTotal"/>
              </LesserOf>
              <Rational>2/37</Rational>
            </Multiply>
          </GreaterOf>
        </Round>
      </Derived>
    </Fact>
    <Fact path="/qualifiedMortgageInterestAndInvestmentInterestExpenses">
      <Name>Qualified mortgage interest and investment interest expenses </Name>
      <Description>Qualified mortgage interest including points (if you're the buyer) and Investment interest (limited to your net investment income)
      </Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/stateAndLocalTaxPayments">
      <Name>State and Local Taxes</Name>
      <Description>There are four types of deductible nonbusiness SALT taxes: 1)
        State, local, and foreign income taxes; 2) State and local general sales taxes; 3) State and
        local real estate taxes; 4) State and local personal property taxes</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/medicalAndDentalExpenses">
      <Name>Estimated medical and dental expenses</Name>
      <Description>Total expenses that exceed 7.5% of your adjusted gross income. Can include the
        total estimated amount paid for health insurance premiums, not including any amount the
        employer pays</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/charitableContributions">
      <Name>Charitable Contributions</Name>
      <Description>Charitable contributions to qualified organizations</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/casualtyLosses">
      <Name>Casualty Losses</Name>
      <Description>Casualty and theft losses relating to your home, household items, and vehicles if
        the loss took place in a federally declared disaster area</Description>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/otherDeductions">
      <Name>Other Deductions</Name>
      <Writable>
        <Dollar/>
      </Writable>
    </Fact>
    <Fact path="/qualifiedMortgageInterestAndInvestmentInterestExpensesTotal">
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="/qualifiedMortgageInterestAndInvestmentInterestExpenses"/>
              </IsComplete>
            </When>
            <Then>
              <Dependency path="/qualifiedMortgageInterestAndInvestmentInterestExpenses"/>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/stateAndLocalTaxPaymentsApplicableLimitationAmount">
      <Name>SALT tax payment applicable limitation amount</Name>
      <Description>Maximum amount that can be itemized for SALT</Description>
      <TaxYear>2025</TaxYear>
      <Derived>
        <Dollar>40000</Dollar>
      </Derived>
    </Fact>
    <Fact path="/stateAndLocalTaxPaymentsTotal">
      <Name>Total of all SALT payments </Name>
      <Description>Total of all SALT payment items, up to $40,000 limit </Description>
      <TaxYear>2025</TaxYear>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Not>
                <IsComplete>
                  <Dependency path="/stateAndLocalTaxPayments"/>
                </IsComplete>
              </Not>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
          <Case>
            <When>
              <GreaterThan>
                <Left>
                  <Dependency path="/stateAndLocalTaxPayments"/>
                </Left>
                <Right>
                  <Dependency path="/stateAndLocalTaxPaymentsApplicableLimitationAmount"/>
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <Dependency path="/stateAndLocalTaxPaymentsApplicableLimitationAmount"/>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dependency path="/stateAndLocalTaxPayments"/>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/medicalAndDentalExpensesTotal">
      <Name>Total of all medical and dental expenses </Name>
      <Description>Aggregated total of all medical and dental expense items </Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="/medicalAndDentalExpenses"/>
              </IsComplete>
            </When>
            <Then>
              <Dependency path="/medicalAndDentalExpenses"/>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/charitableContributionsTotal">
      <Name>Total of all charitable contributions </Name>
      <Description>
        OB3 70425(a) amends IRC 170(b)(1) to only allow this itemized deduction for individuals
        whose aggregate charitable contributions are in excess of %0.5 of their AGI

        MIN of A) Charitable contributions - (0.005 * MAX(contribution base, 0); or B) 0.6 *
        contribution base

      </Description>
      <Derived>
        <GreaterOf>
          <LesserOf>
            <Subtract>
              <Minuend>
                <Dependency path="/charitableContributionsAggregatedAmount"/>
              </Minuend>
              <Subtrahends>
                <Multiply>
                  <Rational>5/1000</Rational>
                  <GreaterOf>
                    <Dependency path="/agi"/>
                    <Dollar>0</Dollar>
                  </GreaterOf>
                </Multiply>
              </Subtrahends>
            </Subtract>
            <Multiply>
              <Rational>60/100</Rational>
              <Dependency path="/agi"/>
            </Multiply>
          </LesserOf>
          <Dollar>0</Dollar>
        </GreaterOf>
      </Derived>
    </Fact>
    <Fact path="/charitableContributionsAggregatedAmount">
      <Name>Total of all charitable contributions </Name>
      <Description>Total of all /charitableContributions items </Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="/charitableContributions"/>
              </IsComplete>
            </When>
            <Then>
              <Dependency path="/charitableContributions"/>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/casualtyLossesTotal">
      <Name>Total of all casualty loss items </Name>
      <Description>Total of all /casualtyLosses items </Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="/casualtyLosses"/>
              </IsComplete>
            </When>
            <Then>
              <Dependency path="/casualtyLosses"/>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/otherDeductionsTotal">
      <Name> Total of all other itemized deductions </Name>
      <Description>Total of all /otherDeductions items </Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="/otherDeductions"/>
              </IsComplete>
            </When>
            <Then>
              <Dependency path="/otherDeductions"/>
            </Then>
          </Case>
          <Case>
            <When>
              <True/>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
  </Facts>
</FactDictionaryModule>
